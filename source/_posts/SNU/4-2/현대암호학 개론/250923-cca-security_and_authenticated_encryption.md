---
title: CCA-Security and Authenticated Encryption
categories:
  - SNU
  - 4-2
  - 현대암호학 개론
date: 2025-09-23 14:18:54
tags:
---

# CCA security

## Motivation

## Definition of CCA security

당연히 Dec oracle에 c를 넣어보면 안 됨

## Ciphertext Tampering Attacks

PRF -> CPA-secure는 CCA-secure하지 않다
(r, s) 받았을 때 Dec oracle에 (r, s') 넣어보면 됨

교훈) non-malleability: ciphertext 조작이 쉬우면 안 됨!!  
e.g. IPsec -> m_1에 dest=80 정보가 들어있다면 m_1'을 dest=25이여도 c_1이 같도록 c_0 (정확히는 IV)를 조작 가능 -> 뒷 내용은 몰라도 header만 쏙 바꿔버릴 수 있음!!  
CBC/CTR mode is not CCA-secure...

# Authenticated Encryption (AE)

To achieve both privacy and integrity from a single primitive, decryption might fail!

- $Enc_k(m) = c$
- $Dec_k(c) = m \lor \bot$, where $\bot$ means that decryption is rejected (or failed).

A scheme should be IND-CPA (indistinguishable under chosen-plaintext attack) and unforgeable to be AE.

## Unforgeability

Adversary cannot create a new ciphertext that decrypts properly!  
This definition is very powerful; Adversary doesn't even need to get information about the plaintext!

## Implications

If a private-key encryption scheme is an AE:

- Adversary cannot distinguish encryptions of two messages.
- Any new ciphertexts generated by the adversary will be invalid, making chosen-ciphertext attacks useless. (i.e. Decryption oracle is meaningless.)
- Nevertheless, it does not protect against replay attacks.

Theorem: If a private-key encryption scheme is an AE, then it is CCA-secure.  
i.e. AE is stronger definition than CCA-secure!

증명 스케치)
A - CCA-secure experiment  
B - Enc, Dec를 쓸 수 있게는 하는데 Enc를 쓸때마다 (m, c) pair를 저장해놓고 Dec는 리스트에 있으면 m 내놓고, 없으면 $\bot$ 내놓음 (사실상 Dec는 무의미)  
C - CPA-secure experiment  
A/B/C는 unforgeability 때문에 서로 차이가 negligible  
근데 AE는 CPA-secure하니까 CCA-secure도 만족

Note that the converse is not true; There exist a CCA-secure private-key encryption schemes that are not AE schemes.  
However, it is difficult to make a CCA-secure scheme that is not an AE scheme...  
Most natural constructions of CCA-secure encryption schemes satisfy the stronger definition of AE.

## Constructing AE

Encryption + MAC?  
여담) 여기선 strong MAC을 써야함 (기존 강의 참고)

MAC then Encrypt는 (m,t)를 encrypt하는거임

셋 다 안전한가?

안전한 순위는?

일단 제일 먼저 1번이 탈락  
이유) MAC은 안전하지 않아도 된다 (t가 m 정보를 포함할 수도 있음)  
최악의 경우에 CPA-secure도 아닐 수도 있음  
사용하려면 전제조건) MAC이 secure해야함

2번은 좋아보이는데 bad-padding attack이 통한다고 함 (찾아보기?)

3번은 항상 AE  
MAC -> unforgeability 만족  
MAC이 ciphertext 유출해도 알빠노 어차피 ciphertext는 CPA-secure (심지어 k2를 줘도 CPA-secure, 물론 MAC이 허벌되니까 unforgeability는 뚫리겠지만...)  
-> CPA + unforge면 뭐다? AE다!

당연히 k1, k2가 같으면 뚫림  
(k를 서로 다른 hash 두 개를 돌려서 H1, H2를 쓰면 안전할거다?)

## Remarks

AEAD: 진짜 데이터는 encrypt, 헤더는 공개해야 하는 경우도 있음

여전히 reordering, replay, message-dropping, reflection attack 등에 뚫린다!  
e.g. session counter 등을 사용  
이건 암호학보단 network security 얘기라 건너뜀
