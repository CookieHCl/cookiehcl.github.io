<!doctype html><html lang=en><meta charset=UTF-8><meta content="width=device-width" name=viewport><meta content=#222 name=theme-color><meta content="Hexo 8.0.0" name=generator><link crossorigin href=https://cdnjs.cloudflare.com rel=preconnect><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css rel=stylesheet><link integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"cookiehcl.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"agate","dark":"agate"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":true,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script defer src=/js/config.js></script><meta content="Reliable data transfer Sender and receiver use reliable data transfer protocol to unreliable channel. Unreliable channel may lose, corrupt, or reorder data. Sender and receiver do not know the state o" name=description><meta content=article property=og:type><meta content="Reliable Data Transfer" property=og:title><meta content=https://cookiehcl.github.io/posts/57/index.html property=og:url><meta content="기억 저장소" property=og:site_name><meta content="Reliable data transfer Sender and receiver use reliable data transfer protocol to unreliable channel. Unreliable channel may lose, corrupt, or reorder data. Sender and receiver do not know the state o" property=og:description><meta content=en_US property=og:locale><meta content=https://cookiehcl.github.io/posts/57/rdt2.0.png property=og:image><meta content=https://cookiehcl.github.io/posts/57/rdt2.1.png property=og:image><meta content=https://cookiehcl.github.io/posts/57/rdt2.2.png property=og:image><meta content=https://cookiehcl.github.io/posts/57/rdt3.0.png property=og:image><meta content=2025-04-02T07:34:36.000Z property=article:published_time><meta content=2025-04-02T07:34:36.000Z property=article:modified_time><meta content=CookieHCl property=article:author><meta content=summary name=twitter:card><meta content=https://cookiehcl.github.io/posts/57/rdt2.0.png name=twitter:image><link href=https://cookiehcl.github.io/posts/57/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://cookiehcl.github.io/posts/57/","path":"posts/57/","title":"Reliable Data Transfer"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Reliable Data Transfer | 기억 저장소</title><script integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script defer src=/js/utils.js></script><script defer src=/js/motion.js></script><script defer src=/js/sidebar.js></script><script defer src=/js/next-boot.js></script><script integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js></script><script defer src=/js/third-party/search/local-search.js></script><script class=next-config data-name=mermaid type=application/json>{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.10.1/mermaid.min.js","integrity":"sha256-BmQmdWDS8X2OTbrwELWK366LV6escyWhHHe0XCTU/Hk="}}</script><script defer src=/js/third-party/tags/mermaid.js></script><script class=next-config data-name=enableMath type=application/json>true</script><link integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css rel=stylesheet><script class=next-config data-name=katex type=application/json>{"copy_tex_js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js","integrity":"sha256-Us54+rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs="}}</script><script defer src=/js/third-party/math/katex.js></script><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label="Toggle navigation bar" class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>기억 저장소</p> <i class=logo-line></i> </a></div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=Search role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>About</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>Tags</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>Categories</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>Archives</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>Search </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=Searching... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>Table of Contents<li class=sidebar-nav-overview>Overview</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>1.</span> <span class=nav-text>Reliable data transfer</span></a><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>2.</span> <span class=nav-text>rdt (Reliable data transfer) protocol</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#rdt1-0-reliable-transfer-over-a-reliable-channel><span class=nav-number>2.1.</span> <span class=nav-text>rdt1.0: reliable transfer over a reliable channel</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Sender><span class=nav-number>2.1.1.</span> <span class=nav-text>Sender</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Receiver><span class=nav-number>2.1.2.</span> <span class=nav-text>Receiver</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#rdt2-0-channel-with-bit-errors><span class=nav-number>2.2.</span> <span class=nav-text>rdt2.0: channel with bit errors</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#rdt2-1-sender-handling-garbled-ACK-NAKs><span class=nav-number>2.3.</span> <span class=nav-text>rdt2.1: sender handling garbled ACK/NAKs</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#rdt2-2-a-NAK-free-protocol><span class=nav-number>2.4.</span> <span class=nav-text>rdt2.2: a NAK-free protocol</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#rdt3-0-channel-with-errors-and-loss><span class=nav-number>2.5.</span> <span class=nav-text>rdt3.0: channel with errors and loss</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Performance-of-rdt3-0-stop-and-wait><span class=nav-number>2.5.1.</span> <span class=nav-text>Performance of rdt3.0 (stop-and wait)</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Pipelining><span class=nav-number>2.6.</span> <span class=nav-text>Pipelining</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Go-Back-N><span class=nav-number>2.6.1.</span> <span class=nav-text>Go-Back-N</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Selective-repeat><span class=nav-number>2.6.2.</span> <span class=nav-text>Selective repeat</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Sequence-number-space><span class=nav-number>2.6.3.</span> <span class=nav-text>Sequence number space</span></a></ol></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><p class=site-author-name itemprop=name>CookieHCl<div class=site-description itemprop=description></div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>109</span> <span class=site-state-item-name>posts</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>25</span> <span class=site-state-item-name>categories</span></a></div></nav></div><div class="links-of-author animated"><span class=links-of-author-item> <a rel="noopener me" title="GitHub → https://github.com/CookieHCl" href=https://github.com/CookieHCl target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a rel="noopener me" title="BOJ → https://www.acmicpc.net/user/CookieHCl" href=https://www.acmicpc.net/user/CookieHCl target=_blank><i class="fa fa-code fa-fw"></i>BOJ</a> </span><span class=links-of-author-item> <a rel="noopener me" title="solved.ac → https://solved.ac/profile/CookieHCl" href=https://solved.ac/profile/CookieHCl target=_blank><i class="fa fa-audio-description fa-fw"></i>solved.ac</a> </span></div><div class="cc-license animated" itemprop=license><a class=cc-opacity href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ko rel=noopener target=_blank><img alt="Creative Commons" src=https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg></a></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=en><link href=https://cookiehcl.github.io/posts/57/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/images/avatar.gif itemprop=image> <meta content=CookieHCl itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="기억 저장소" itemprop=name> <meta itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="Reliable Data Transfer | 기억 저장소" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>Reliable Data Transfer</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>Posted on</span> <time itemprop="dateCreated datePublished" title="Created: 2025-04-02 16:34:36" datetime=2025-04-02T16:34:36+09:00>2025-04-02</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>In</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/ itemprop=url rel=index><span itemprop=name>SNU</span></a> </span> , <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/4-1/ itemprop=url rel=index><span itemprop=name>4-1</span></a> </span> , <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/4-1/%EC%BB%B4%ED%93%A8%ED%84%B0%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC/ itemprop=url rel=index><span itemprop=name>컴퓨터네트워크</span></a> </span> </span><span title="Reading time" class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>Reading time ≈</span> <span>3 mins.</span> </span></div></div></header><div class=post-body itemprop=articleBody><h1>Reliable data transfer</h1><p>Sender and receiver use reliable data transfer protocol to unreliable channel.<br> Unreliable channel may lose, corrupt, or reorder data.<br> Sender and receiver do not know the state of each other. e.g. Was a message received?<p>Assumes transport layer is reliable!<br> i.e. data &lt;-> packet is reliable<h1>rdt (Reliable data transfer) protocol</h1><ul><li><code>rdt_send()</code>: Application call it to send data.<li><code>udt_send()</code>: Called by rdt to transfer packet over unreliable channel to receiver<li><code>rdt_rcv()</code>: Called when packet arrives on receiver side of unreliable channel<li><code>deliver_data()</code>: Called by rdt to deliver data to application.</ul><p>We consider only unidirectional data transfer, but control info will flow in both directions.<br> We use FSMs to specify sender and receiver.<h2 id=rdt1-0-reliable-transfer-over-a-reliable-channel>rdt1.0: reliable transfer over a reliable channel</h2><p>We have reliable channel, do nothing!<h3 id=Sender>Sender</h3><figure class="highlight c"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=type>void</span> <span class="title function_">rdt_send</span><span class=params>(data)</span> {</span><br><span class=line>  packet = make_pkt(data)</span><br><span class=line>  udt_send(packet)</span><br><span class=line>}</span><br></pre></table></figure><h3 id=Receiver>Receiver</h3><figure class="highlight c"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=type>void</span> <span class="title function_">rdt_rcv</span><span class=params>(packet)</span> {</span><br><span class=line>  data = extract(packet)</span><br><span class=line>  deliver_data(data)</span><br><span class=line>}</span><br></pre></table></figure><h2 id=rdt2-0-channel-with-bit-errors>rdt2.0: channel with bit errors</h2><p>Underlying channel may flip bits in packet!<br> We can use checksum to detect bit errors.<br> When error happens, we have to recover from errors!<p>We'll use stop and wait method - sender sends one packet, then waits for receiver response.<ul><li>ACK(Acknowledgements): receiver explicitly tells sender that packet was successfully received.<li>NAK(Negative acknowledgements): receiver explicitly tells sender that packet had errors.</ul><p>Sender waits for receiver response, and retransmit packets on NAK.<br> These are called <strong>control packets</strong>, it doesn't transmits actual data.<p><img alt=rdt2.0 src=rdt2.0.png><p>But this has a fatal flaw!<br> What happens if ACK/NAK is corrupted?<br> What should we do if ACK/NAK is corrupted?<h2 id=rdt2-1-sender-handling-garbled-ACK-NAKs>rdt2.1: sender handling garbled ACK/NAKs</h2><p>Sender doesn't know what happened at receiver.<br> We can't just retransmit: receiver doesn't know whether this is a retransmittion or a new transmittion.<p>We use sequence number!<ul><li>Sender adds sequence number to each packet.<li>Receiver checks sequence number and discard duplicate packet.<li>Sender retransmits current packet if ACK/NAK is corrupted.<li>Receiver <strong>should send ACK</strong> when duplicate packet arrive.</ul><p>Still use stop and wait method - sender sends one packet, then waits for receiver response.<p><img alt=rdt2.1 src=rdt2.1.png><p>We can only use two sequence number (0, 1).<br> We have twice as many states because we use two sequence number.<h2 id=rdt2-2-a-NAK-free-protocol>rdt2.2: a NAK-free protocol</h2><p>Actually, NAK is redundant!<br> Instead of NAK, receiver sends ACK with sequence number of the last packet received.<br> Duplicate ACK at sender results in same action as NAK: we retransmit current packet.<p><img alt=rdt2.2 src=rdt2.2.png><h2 id=rdt3-0-channel-with-errors-and-loss>rdt3.0: channel with errors and loss</h2><p>Underlying channel may lose packets - data or control packets. In practice, bit errors are rare these days, and loss and delay are much more problematic.<p>Approach: sender waits reasonable amount of time for ACK!<ul><li>Sender waits reasonable amount of time for ACK.<li>Sender retransmits if no ACK is received in this time.</ul><p>Packet can be just delayed, and retransmission will be duplicate.<br> However, we're already handling duplicate packet!<p><img alt=rdt3.0 src=rdt3.0.png><p>Only sender maintains timeout. i.e. receiver don't have to retransmit ACKs.<br> Receiver is same from rdt2.2!<h3 id=Performance-of-rdt3-0-stop-and-wait>Performance of rdt3.0 (stop-and wait)</h3><p>U: sender's utilization, i.e. fraction of time sender busy seding<p>Let's assume link has 1Gbps bandwidth, propagation delay is 15ms, and packet size is 8000 bits.<ul><li>Time to transmit packet into channel: 8000bits / 1Gbps = 8μs<li>Round-trip time: 2 propagation delay = 30ms</ul><p>Utilization = 8μs / (30ms + 8μs) = 0.00027<br> Sender is almost always idle!<h2 id=Pipelining>Pipelining</h2><p>Send multiple packets at once!<br> Range of sequence numbers must be increased.<br> Sender and receiver need buffering.<p>In theory, sender can send until it receive response.<br> i.e. Sender can send bandwidth * RTT bits of packets!<h3 id=Go-Back-N>Go-Back-N</h3><ul><li><p>Sender have a window up to N consecutive transmitted but unACKed packets.</p><li><p>On receiving ACK(n), move window forward to begin at n + 1.</p><li><p>Timeout should be checked only for oldest packet sent.</p><li><p>If timeout(n) happenes, retransmit every packet from n.</p><li><p>Receiver always record highest in-order sequence number of correctly-received packet so far called <code>rcv_base</code>.</p><li><p>On receipt of out-of-order packet, receiver can discard or buffer it.</p> <ul><li>Buffering is better, but sometimes you have to implement in hardware (e.g. RDMA), so it is possible for receiver to just discard packet.</ul><li><p>Receiver always ACK with <code>rcv_base</code> when it receives any packet.</p></ul><h3 id=Selective-repeat>Selective repeat</h3><ul><li><p>Sender uses a window up to N packets.</p><li><p>Sender maintains timer for each unACKed packet.</p><li><p>Sender timeout/retransmits indivually for unACKed packets.</p><li><p>On receiving ACK(n), mark packet n as received.</p><li><p>If n is the smallest unACKed sequence number, advance window to next unACKed sequence number.</p><li><p>Receiver individually ACK all correctly received packets</p><li><p>On receipt of out-of-order packet, receiver buffer it.</p><li><p>On receipt of in-order packet, receiver deliver buffered, in-order packets to application, and remove packets from buffer.</p></ul><p>Head-of-line blocking happens here!<br> If the smallest unACKed packet is delayed, the whole transmission is delayed.<h3 id=Sequence-number-space>Sequence number space</h3><p>We can't increase number infinitely!<p>Go-Back-N use at least N + 1 sequence numbers.<br> Selective repeat use at least 2N sequence numbers.<p>In reality, packets can sent and received out of order.<br> Specification says that MSL (Maximum Segment Lifetime) should be 120s ~ 3 min.</div><footer class=post-footer><div class=post-nav><div class=post-nav-item><a title="Introduction to Geometry" href=/posts/56/ rel=prev> <i class="fa fa-angle-left"></i> Introduction to Geometry </a></div><div class=post-nav-item><a href=/posts/62/ rel=next title=Splines> Splines <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div><div class="comments utterances-container"></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© 2023 – <span itemprop=copyrightYear>2025</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>CookieHCl</span></div><div class=powered-by>Powered by <a href=https://hexo.io/ rel=noopener target=_blank>Hexo</a> & <a href=https://theme-next.js.org/muse/ rel=noopener target=_blank>NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label="Back to top" class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><div class=reading-progress-bar></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script class=next-config data-name=utterances type=application/json>{"enable":true,"repo":"CookieHCl/cookiehcl.github.io","issue_term":"pathname","theme":"github-light"}</script><script defer src=/js/third-party/comments/utterances.js></script>