<!doctype html><html lang=en><meta charset=UTF-8><meta content="width=device-width" name=viewport><meta content=#222 name=theme-color><meta content="Hexo 8.1.1" name=generator><link crossorigin href=https://cdnjs.cloudflare.com rel=preconnect><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css rel=stylesheet><link integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"cookiehcl.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"agate","dark":"agate"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":true,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script defer src=/js/config.js></script><meta content="Memory Address Space  User process uses virtual address space, while hardware such as memory uses physical address space. Device has its own MMU (memory management unit) for virtual to physical addres" name=description><meta content=article property=og:type><meta content="Reading Data from Memory" property=og:title><meta content=https://cookiehcl.github.io/posts/82/index.html property=og:url><meta content="기억 저장소" property=og:site_name><meta content="Memory Address Space  User process uses virtual address space, while hardware such as memory uses physical address space. Device has its own MMU (memory management unit) for virtual to physical addres" property=og:description><meta content=en_US property=og:locale><meta content=https://cookiehcl.github.io/posts/82/memory_address_space.png property=og:image><meta content=https://cookiehcl.github.io/posts/82/wide_transfer.png property=og:image><meta content=https://cookiehcl.github.io/posts/82/narrow_transfer.png property=og:image><meta content=https://cookiehcl.github.io/posts/82/multiple_outstanding_requests.png property=og:image><meta content=https://cookiehcl.github.io/posts/82/interconnect_implementaion.png property=og:image><meta content=https://cookiehcl.github.io/posts/82/dram.png property=og:image><meta content=https://cookiehcl.github.io/posts/82/dram_cell.png property=og:image><meta content=https://cookiehcl.github.io/posts/82/bank_interleaving.png property=og:image><meta content=2025-05-27T01:05:45.000Z property=article:published_time><meta content=2025-05-27T01:05:45.000Z property=article:modified_time><meta content=CookieHCl property=article:author><meta content=summary name=twitter:card><meta content=https://cookiehcl.github.io/posts/82/memory_address_space.png name=twitter:image><link href=https://cookiehcl.github.io/posts/82/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://cookiehcl.github.io/posts/82/","path":"posts/82/","title":"Reading Data from Memory"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Reading Data from Memory | 기억 저장소</title><script integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script defer src=/js/utils.js></script><script defer src=/js/motion.js></script><script defer src=/js/sidebar.js></script><script defer src=/js/next-boot.js></script><script integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js></script><script defer src=/js/third-party/search/local-search.js></script><script class=next-config data-name=mermaid type=application/json>{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.10.1/mermaid.min.js","integrity":"sha256-BmQmdWDS8X2OTbrwELWK366LV6escyWhHHe0XCTU/Hk="}}</script><script defer src=/js/third-party/tags/mermaid.js></script><script class=next-config data-name=enableMath type=application/json>true</script><link integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css rel=stylesheet><script class=next-config data-name=katex type=application/json>{"copy_tex_js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js","integrity":"sha256-Us54+rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs="}}</script><script defer src=/js/third-party/math/katex.js></script><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label="Toggle navigation bar" class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>기억 저장소</p> <i class=logo-line></i> </a></div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=Search role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>About</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>Tags</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>Categories</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>Archives</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>Search </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=Searching... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>Table of Contents<li class=sidebar-nav-overview>Overview</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>1.</span> <span class=nav-text>Memory Address Space</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#Virtual-address-space><span class=nav-number>1.1.</span> <span class=nav-text>Virtual address space</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Translation-Look-aside-Buffers-TLB><span class=nav-number>1.2.</span> <span class=nav-text>Translation Look-aside Buffers (TLB)</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#IOMMU><span class=nav-number>1.3.</span> <span class=nav-text>IOMMU</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>2.</span> <span class=nav-text>Interconnect</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#AXI-Advanced-Extensable-Interface-Protocol><span class=nav-number>2.1.</span> <span class=nav-text>AXI (Advanced Extensable Interface) Protocol</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Burst-transfer><span class=nav-number>2.2.</span> <span class=nav-text>Burst transfer</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Type-of-burst-transfer><span class=nav-number>2.2.1.</span> <span class=nav-text>Type of burst transfer</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Multiple-Outstanding-Requests><span class=nav-number>2.2.2.</span> <span class=nav-text>Multiple Outstanding Requests</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Handshake-signal><span class=nav-number>2.3.</span> <span class=nav-text>Handshake signal</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Stop-and-wait-method><span class=nav-number>2.3.1.</span> <span class=nav-text>Stop-and wait method</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Single-Credit-based-Flow-Control><span class=nav-number>2.3.2.</span> <span class=nav-text>Single Credit-based Flow Control</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Implementation-of-Interconnect><span class=nav-number>2.4.</span> <span class=nav-text>Implementation of Interconnect</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Arbitration-scheme><span class=nav-number>2.4.1.</span> <span class=nav-text>Arbitration scheme</span></a></ol></ol><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>3.</span> <span class=nav-text>DRAM</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#DRAM-cell><span class=nav-number>3.1.</span> <span class=nav-text>DRAM cell</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#DRAM-Timing><span class=nav-number>3.2.</span> <span class=nav-text>DRAM Timing</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#DRAM-pin><span class=nav-number>3.3.</span> <span class=nav-text>DRAM pin</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Reading-a-single-tile-from-DRAM><span class=nav-number>3.4.</span> <span class=nav-text>Reading a single tile from DRAM</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Address-mapping><span class=nav-number>3.4.1.</span> <span class=nav-text>Address mapping</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Spatial-Locality><span class=nav-number>3.4.2.</span> <span class=nav-text>Spatial Locality</span></a></ol></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><p class=site-author-name itemprop=name>CookieHCl<div class=site-description itemprop=description></div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>109</span> <span class=site-state-item-name>posts</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>25</span> <span class=site-state-item-name>categories</span></a></div></nav></div><div class="links-of-author animated"><span class=links-of-author-item> <a rel="noopener me" title="GitHub → https://github.com/CookieHCl" href=https://github.com/CookieHCl target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a rel="noopener me" title="BOJ → https://www.acmicpc.net/user/CookieHCl" href=https://www.acmicpc.net/user/CookieHCl target=_blank><i class="fa fa-code fa-fw"></i>BOJ</a> </span><span class=links-of-author-item> <a rel="noopener me" title="solved.ac → https://solved.ac/profile/CookieHCl" href=https://solved.ac/profile/CookieHCl target=_blank><i class="fa fa-audio-description fa-fw"></i>solved.ac</a> </span></div><div class="cc-license animated" itemprop=license><a class=cc-opacity href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ko rel=noopener target=_blank><img alt="Creative Commons" src=https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg></a></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=en><link href=https://cookiehcl.github.io/posts/82/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/images/avatar.gif itemprop=image> <meta content=CookieHCl itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="기억 저장소" itemprop=name> <meta itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="Reading Data from Memory | 기억 저장소" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>Reading Data from Memory</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>Posted on</span> <time itemprop="dateCreated datePublished" title="Created: 2025-05-27 10:05:45" datetime=2025-05-27T10:05:45+09:00>2025-05-27</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>In</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/ itemprop=url rel=index><span itemprop=name>SNU</span></a> </span> , <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/4-1/ itemprop=url rel=index><span itemprop=name>4-1</span></a> </span> , <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/4-1/%ED%95%98%EB%93%9C%EC%9B%A8%EC%96%B4%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%84%A4%EA%B3%84/ itemprop=url rel=index><span itemprop=name>하드웨어시스템설계</span></a> </span> </span><span title="Reading time" class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>Reading time ≈</span> <span>5 mins.</span> </span></div></div></header><div class=post-body itemprop=articleBody><h1>Memory Address Space</h1><p><img alt="Memory Address Space" src=memory_address_space.png><p>User process uses virtual address space, while hardware such as memory uses physical address space.<p>Device has its own MMU (memory management unit) for virtual to physical address translation.<h2 id=Virtual-address-space>Virtual address space</h2><p>Because of memory fragmentation, large contiguous memory resource in physical address is hard to find.<p>Page table is used to keep virtual to physical address mapping information.<br> It stores virtual page number, access rights, and its corresponding physical page number.<br> The offset (usually 12 bits, page size is 4KB) remains the same for both the virtual and physical addresses.<p>To reduce size of page table, we often use hierarchical page table.<br> e.g. 10-bit L1 index, 10-bit L2 index, 12-bit offset<h2 id=Translation-Look-aside-Buffers-TLB>Translation Look-aside Buffers (TLB)</h2><p>Address translation is very expensive!<br> Hierarchical page table makes it worse, 2-level page table need 3 memory accesses for each physical memory access. c.f. This happens whenever we access hardware components!!<p>We cache translations in TLB. If TLB hits, only single memory access is needed!<br> Usually we have seperate TLB for instruction and data.<p>But if TLB misses, we still need multiple memory accesses.<br> We use MMU cache to store intermediate page table's cache.<h2 id=IOMMU>IOMMU</h2><p>Each hardware devices (including CPU) has its own virtual address space and page table.<p>More than 15 years ago, each hardware device used a contiguous region of physical address directly.<br> However, this wastes main memory resources if not all hardware devices are being used.<br> Moreover, devices such as smartphones have so many hardware devices that we run out of main memory.<p>IOMMU provides demand paging, which enables better utilization of memory resource and offers more memory resource for user applications.<p>To reduce cost of page table and TLB miss, we share page table with CPU, and we use L2 TLB (shared by devices and CPU) as well as L1 TLB (local to device).<h1>Interconnect</h1><h2 id=AXI-Advanced-Extensable-Interface-Protocol>AXI (Advanced Extensable Interface) Protocol</h2><ul><li>Write address channel (AW, input)<li>Write data channel (W, input)<li>Write response channel (B, output)<li>Read address channel (AR, input)<li>Read data channel (R, output)</ul><p>Each channel have valid & ready signals. (handshake signals)<p>AXI can send 128 bit at once, but only use 32 bit as a data.<br> Other bits are used for signals, e.g. handshake signals, burst length/size/type, protection type, write strobes, ...<h2 id=Burst-transfer>Burst transfer</h2><p>Write address channel have signals that determines burst transfer.<br> Burst transfer can send data over multiple cycles, while sending address information for only 1 cycle.<ul><li>AWADDR[31:0] Write addr ID<li>AWLEN[3:0] Burst length<li>AWSIZE[2:0] Burst size (Actually data is called beat, so this should be called beat size?)<li>AWBURST[1:0] Burst type</ul><p>We also have read version of burst transfer! (e.g. ARADDR, ARLEN, ...)<p><img alt="Wide transfer" src=wide_transfer.png><p>Wide transfer: Burst data's size is same as word size.<p><img alt="Narrow transfer" src=narrow_transfer.png><p>Narrow transfer: Burst data's size is smaller than word size.<br> In narrow transfer, we can determine where data exists (e.g. whether it starts from MSB) by looking at address.<p>Of course, sending multiple data at once can save clock cycle.<br> However, due to hardware limitations, data might not be available at once.<h3 id=Type-of-burst-transfer>Type of burst transfer</h3><ul><li>INCR: Normal behavior, incrementing-address burst.<li>FIXED: Fixed-address burst, for FIFOs.<li>WRAP: Incrementing-address burst, but wraps to a lower address at the wrap boundary</ul><h3 id=Multiple-Outstanding-Requests>Multiple Outstanding Requests</h3><p><img alt="Multiple Outstanding Requests" src=multiple_outstanding_requests.png><p>Because we merged multiple data requests into single burst transfer request, address channel have free cycles.<p>If we can use this free cycles and send another burst transfer request during burst transfer, we can reduce average memory latency.<p>If we can access multiple memory banks at once, and send multiple data at once, we can achieve parallelism!<p>e.g. Non-blocking caches!<br> If cache can hit under multiple miss (cache can send hit data when fetching miss data), or miss under miss (cache can fetch multiple miss data in parallel), we can reduce effective miss penalty!<h2 id=Handshake-signal>Handshake signal</h2><h3 id=Stop-and-wait-method>Stop-and wait method</h3><p>Traditional stop-and-wait method use request and acknowledge.<ol><li>Sender sends request + data at clock 0.<li>Receiver receives, and set acknowledge at clock 1.<li>Now sender can send next request + data at clock 2.</ol><p>Problem: Sender can't send data at each cycle!<h3 id=Single-Credit-based-Flow-Control>Single Credit-based Flow Control</h3><p>Instead of acknowledge signal, receiver uses ready signal (credit).<br> Receiver set ready signal if receiver have free space.<p>Sender can send next request + data if ready signal was set at the previous clock.<br> We can send data at each cycle! 100% utilization can be achieved.<p>Data is transfered when valid (request signal) and ready signal are both set at the rising edge of the clock.<h2 id=Implementation-of-Interconnect>Implementation of Interconnect</h2><p><img alt="Implementation of Interconnect" src=interconnect_implementaion.png><p>Interconnect can be implemented with decoders and arbiters.<br> Decoder send data to the desired output, and arbiter receive data from the desired input.<p>In practice, not all decoders and arbiters are connected.<h3 id=Arbitration-scheme>Arbitration scheme</h3><p>What should we do when arbiter receive multiple inputs at once?<ul><li>Fixed priority: Easy, but starvation occurs at worst case<li>Round robin: Cycle priority! Looks fine, but depending on the request pattern, this is actually not fair<li>LRG (least recently granted): (We use hybrid method, so each group's priority is fixed.) If a master was granted access, that master will have the lowest priority in the group at the next cycle.</ul><h1>DRAM</h1><p><img alt=DRAM src=dram.png><p>Data is stored in 2D array of memory cell.<br> Row address decoder selects target row, then read the entire word.<br> Column decoder selects bit line, then read/write specific bits.<p>Single DRAM consists multiple data bank, and each bank consists multiple 2D array of memory cell.<br> To achieve parallelism, memory requests should be served by multiple banks, or by the same row.<h2 id=DRAM-cell>DRAM cell</h2><p><img alt="DRAM cell" src=dram_cell.png><p>Each cell can be viewed as half full capacitor, switch, and capacitor that stores data (fully charged if data is 1, empty if data is 0).<ol><li>Charge Sharing: Both capacitor shares charge.<li>Sensing & Amplification: Sense amplifier amplifies difference to make both capacitor full/empty.<li>Precharging: Switch is turn off, and capacitor is restored to the half full state.</ol><p>We can read before amplification is fully finished!<br> In fact, after row access, column access happens when we can read data from DRAM.<h2 id=DRAM-Timing>DRAM Timing</h2><ul><li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>t</mi><mrow><mi>R</mi><mi>C</mi></mrow></msub></mrow><annotation encoding=application/x-tex>t_{RC}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em;>RC</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>: Minimum time from the start of one row access to the start of the next row access. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>t</mi><mrow><mi>R</mi><mi>C</mi></mrow></msub><mo>=</mo><msub><mi>t</mi><mrow><mi>R</mi><mi>A</mi><mi>S</mi></mrow></msub><mo>+</mo><msub><mi>t</mi><mrow><mi>R</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=application/x-tex>t_{RC} = t_{RAS} + t_{RP}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em;>RC</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.00773em;>R</span><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style=margin-right:0.05764em;>S</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>RP</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span><li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>t</mi><mrow><mi>R</mi><mi>C</mi><mi>D</mi></mrow></msub></mrow><annotation encoding=application/x-tex>t_{RCD}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em;>RC</span><span class="mord mathnormal mtight" style=margin-right:0.02778em;>D</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>: Minimum time from row activation to column activation. (i.e. minimum time when data is available to read)<li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>t</mi><mrow><mi>C</mi><mi>L</mi></mrow></msub></mrow><annotation encoding=application/x-tex>t_{CL}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em;>C</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>: Column activation latency.<li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>t</mi><mrow><mi>R</mi><mi>A</mi><mi>S</mi></mrow></msub></mrow><annotation encoding=application/x-tex>t_{RAS}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.00773em;>R</span><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style=margin-right:0.05764em;>S</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>: Activation latency.<li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>t</mi><mrow><mi>R</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=application/x-tex>t_{RP}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>RP</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>: Precharge latency.</ul><p>Usually DRAM timing is written as CL - <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>t</mi><mrow><mi>R</mi><mi>P</mi></mrow></msub></mrow><annotation encoding=application/x-tex>t_{RP}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>RP</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> - <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>t</mi><mrow><mi>R</mi><mi>C</mi><mi>D</mi></mrow></msub></mrow><annotation encoding=application/x-tex>t_{RCD}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7651em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em;>RC</span><span class="mord mathnormal mtight" style=margin-right:0.02778em;>D</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>.<br> e.g. 3-3-3 means 3 cycles for each of activation, read/write, and precharge.<h2 id=DRAM-pin>DRAM pin</h2><p>Input/output pin is called DQ pin.<br> It acts like a global bus, and multiple banks are connected to DQ.<br> However, this means we cannot read multiple banks at once.<p>Currently DRAM reads data from memory banks in serial manner.<br> <s>Make it parallel and get the Turing Award!</s><p>DDR, DDR2, DDR3 means the clock cycle of the bus (DQ).<br> DDR2 has 400MHz clock, DDR3 has 800MHz clock.<br> This is easily achieved by reading more data at once, then send it using higher frequency clock.<br> However, reducing internal latency is very hard because internal latency is proportional to the memory area.<h2 id=Reading-a-single-tile-from-DRAM>Reading a single tile from DRAM</h2><p>Recall) We were doing matrix multiplication!<br> How do we read 4x4 tile matrix?<p><img alt="Bank interleaving" src=bank_interleaving.png><p>Sending four read requests sequentially will give long latency of tile read.<br> Instead of storing matrix in one bank, if we can store four rows in different banks, (bank interleaving) we can achieve higher memory utilization!<h3 id=Address-mapping>Address mapping</h3><p>How can we remap the original address for bank interleaving?<p>Conventionally, physical address is mapped as <code>&lt;bank, row, column></code>.<br> However, if we remap as <code>&lt;row, bank, column></code>, we can naturally get bank interleaving!<br> This is called RBC mapping.<h3 id=Spatial-Locality>Spatial Locality</h3><p>The best memory pattern is to store tile matrix in a single row of the bank.<br> We only need a single activation stage!<p>This is usually done by modifing source code, compiler will do the rest!<br> Hot and highly correlated arrays are allocated to the near memory addresses, i.e. on the same DRAM row.</div><footer class=post-footer><div class=post-nav><div class=post-nav-item><a href=/posts/92/ rel=prev title=LAN> <i class="fa fa-angle-left"></i> LAN </a></div><div class=post-nav-item><a title="Spatial Data Structure" href=/posts/83/ rel=next> Spatial Data Structure <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div><div class="comments utterances-container"></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© 2023 – <span itemprop=copyrightYear>2025</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>CookieHCl</span></div><div class=powered-by>Powered by <a href=https://hexo.io/ rel=noopener target=_blank>Hexo</a> & <a href=https://theme-next.js.org/muse/ rel=noopener target=_blank>NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label="Back to top" class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><div class=reading-progress-bar></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script class=next-config data-name=utterances type=application/json>{"enable":true,"repo":"CookieHCl/cookiehcl.github.io","issue_term":"pathname","theme":"github-light"}</script><script defer src=/js/third-party/comments/utterances.js></script>