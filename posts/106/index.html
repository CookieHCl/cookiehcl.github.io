<!doctype html><html lang=en><meta charset=UTF-8><meta content="width=device-width" name=viewport><meta content=#222 name=theme-color><meta content="Hexo 8.0.0" name=generator><link crossorigin href=https://cdnjs.cloudflare.com rel=preconnect><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css rel=stylesheet><link integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"cookiehcl.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.25.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"agate","dark":"agate"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":true,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script defer src=/js/config.js></script><meta content="Security for multiple encryptions Generally, a secret key is used more than once. We cannot assume single ciphertext attack! We'll now assume chosen-plaintext attacks (CPA). Adversary can control over" name=description><meta content=article property=og:type><meta content="CPA Security and Private-key Encryptions" property=og:title><meta content=https://cookiehcl.github.io/posts/106/index.html property=og:url><meta content="기억 저장소" property=og:site_name><meta content="Security for multiple encryptions Generally, a secret key is used more than once. We cannot assume single ciphertext attack! We'll now assume chosen-plaintext attacks (CPA). Adversary can control over" property=og:description><meta content=en_US property=og:locale><meta content=https://cookiehcl.github.io/posts/106/cpa_indistinguishability.png property=og:image><meta content=https://cookiehcl.github.io/posts/106/cpa_indistinguishability_multiple.png property=og:image><meta content=https://cookiehcl.github.io/posts/106/ecb.png property=og:image><meta content=https://cookiehcl.github.io/posts/106/ecb_penguin.png property=og:image><meta content=https://cookiehcl.github.io/posts/106/cbc.png property=og:image><meta content=https://cookiehcl.github.io/posts/106/ctr.png property=og:image><meta content=2025-09-16T05:05:41.000Z property=article:published_time><meta content=2025-09-16T05:05:41.000Z property=article:modified_time><meta content=CookieHCl property=article:author><meta content=summary name=twitter:card><meta content=https://cookiehcl.github.io/posts/106/cpa_indistinguishability.png name=twitter:image><link href=https://cookiehcl.github.io/posts/106/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://cookiehcl.github.io/posts/106/","path":"posts/106/","title":"CPA Security and Private-key Encryptions"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>CPA Security and Private-key Encryptions | 기억 저장소</title><script integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script defer src=/js/utils.js></script><script defer src=/js/motion.js></script><script defer src=/js/sidebar.js></script><script defer src=/js/next-boot.js></script><script integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js></script><script defer src=/js/third-party/search/local-search.js></script><script class=next-config data-name=mermaid type=application/json>{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.10.1/mermaid.min.js","integrity":"sha256-BmQmdWDS8X2OTbrwELWK366LV6escyWhHHe0XCTU/Hk="}}</script><script defer src=/js/third-party/tags/mermaid.js></script><script class=next-config data-name=enableMath type=application/json>true</script><link integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css rel=stylesheet><script class=next-config data-name=katex type=application/json>{"copy_tex_js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js","integrity":"sha256-Us54+rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs="}}</script><script defer src=/js/third-party/math/katex.js></script><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label="Toggle navigation bar" class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>기억 저장소</p> <i class=logo-line></i> </a></div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=Search role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>About</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>Tags</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>Categories</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>Archives</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>Search </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=Searching... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>Table of Contents<li class=sidebar-nav-overview>Overview</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>1.</span> <span class=nav-text>Security for multiple encryptions</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#CPA-security><span class=nav-number>1.1.</span> <span class=nav-text>CPA-security</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#CPA-security-for-Multiple-Encryptions><span class=nav-number>1.1.1.</span> <span class=nav-text>CPA-security for Multiple Encryptions</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#plaintext-length><span class=nav-number>1.1.2.</span> <span class=nav-text>plaintext length</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#CPA-security-from-PRF><span class=nav-number>1.2.</span> <span class=nav-text>CPA security from PRF</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>2.</span> <span class=nav-text>Modes of operation</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#Electronic-Code-Book-ECB-Mode><span class=nav-number>2.1.</span> <span class=nav-text>Electronic Code Book (ECB) Mode</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Cipher-Block-Chaining-CBC-Mode><span class=nav-number>2.2.</span> <span class=nav-text>Cipher Block Chaining (CBC) Mode</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Counter-CTR-Mode><span class=nav-number>2.3.</span> <span class=nav-text>Counter (CTR) Mode</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Nonce-based-Encryption><span class=nav-number>2.4.</span> <span class=nav-text>Nonce-based Encryption</span></a></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><p class=site-author-name itemprop=name>CookieHCl<div class=site-description itemprop=description></div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>104</span> <span class=site-state-item-name>posts</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>24</span> <span class=site-state-item-name>categories</span></a></div></nav></div><div class="links-of-author animated"><span class=links-of-author-item> <a rel="noopener me" title="GitHub → https://github.com/CookieHCl" href=https://github.com/CookieHCl target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a rel="noopener me" title="BOJ → https://www.acmicpc.net/user/CookieHCl" href=https://www.acmicpc.net/user/CookieHCl target=_blank><i class="fa fa-code fa-fw"></i>BOJ</a> </span><span class=links-of-author-item> <a rel="noopener me" title="solved.ac → https://solved.ac/profile/CookieHCl" href=https://solved.ac/profile/CookieHCl target=_blank><i class="fa fa-audio-description fa-fw"></i>solved.ac</a> </span></div><div class="cc-license animated" itemprop=license><a class=cc-opacity href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ko rel=noopener target=_blank><img alt="Creative Commons" src=https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg></a></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=en><link href=https://cookiehcl.github.io/posts/106/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/images/avatar.gif itemprop=image> <meta content=CookieHCl itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="기억 저장소" itemprop=name> <meta itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="CPA Security and Private-key Encryptions | 기억 저장소" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>CPA Security and Private-key Encryptions</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>Posted on</span> <time itemprop="dateCreated datePublished" title="Created: 2025-09-16 14:05:41" datetime=2025-09-16T14:05:41+09:00>2025-09-16</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>In</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/ itemprop=url rel=index><span itemprop=name>SNU</span></a> </span> , <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/4-2/ itemprop=url rel=index><span itemprop=name>4-2</span></a> </span> , <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/4-2/%ED%98%84%EB%8C%80%EC%95%94%ED%98%B8%ED%95%99-%EA%B0%9C%EB%A1%A0/ itemprop=url rel=index><span itemprop=name>현대암호학 개론</span></a> </span> </span><span title="Reading time" class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>Reading time ≈</span> <span>10 mins.</span> </span></div></div></header><div class=post-body itemprop=articleBody><h1>Security for multiple encryptions</h1><p>Generally, a secret key is used more than once.<br> We cannot assume single ciphertext attack!<p>We'll now assume chosen-plaintext attacks (CPA).<br> Adversary can control over what the honest parties encrypt.<br> The adversary can influence a party to encrypt certain messages and observe the resulting ciphertexts.<br> Later the attacker observes a ciphertext of some unknown meessage.<h2 id=CPA-security>CPA-security</h2><p><img alt="CPA indistinguishability experiments" src=cpa_indistinguishability.png><ol><li>A key <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>k</mi><mo>←</mo><mi>G</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding=application/x-tex>k \leftarrow Gen</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal" style=margin-right:0.03148em;>k</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>←</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">G</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span></span></span></span> is generated.<li>The adversary <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> is given oracle access to <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Enc_k(\cdot)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span>. i.e. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> can receive any number of ciphertexts <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>c</mi><mo>∗</mo></msup><mo>←</mo><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msup><mi>m</mi><mo>∗</mo></msup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c^* \leftarrow Enc_k(m^*)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6887em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6887em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>←</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6887em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> for messages <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>m</mi><mo>∗</mo></msup></mrow><annotation encoding=application/x-tex>m^*</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6887em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6887em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> of its choice.<li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> outputs a pair of messages <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>m_0, m_1</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>. A ciphertext <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>c</mi><mo>←</mo><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c \leftarrow Enc_k(m_b)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">c</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>←</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> is computed and given to <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>.<li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> continues to have oracle access to <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Enc_k(\cdot)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span>. Then it outputs a bit <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>b</mi><mo lspace=0em mathvariant=normal rspace=0em>′</mo></msup></mrow><annotation encoding=application/x-tex>b'</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7519em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7519em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>.</ol><p>The advantage of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> is defined to be <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi mathvariant=script>E</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msub><mi>P</mi><mrow><mn>0</mn><mo separator=true>,</mo><mi mathvariant=script>E</mi></mrow></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo><mo>−</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msub><mi>P</mi><mrow><mn>1</mn><mo separator=true>,</mo><mi mathvariant=script>E</mi></mrow></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo><mi mathvariant=normal>∣</mi></mrow><annotation encoding=application/x-tex>Adv_{\mathcal{E}}(\mathcal{A}) = |\Pr[EXP_{0, \mathcal{E}}(\mathcal{A}) = 1] - \Pr[EXP_{1, \mathcal{E}}(\mathcal{A}) = 1]|</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class=mord>∣</span><span class=mspace style=margin-right:0.1667em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>]</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>]</span><span class=mord>∣</span></span></span></span>.<p>Def: A private-key encryption scheme <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>E</mi></mrow><annotation encoding=application/x-tex>\mathcal{E}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.08944em;>E</span></span></span></span> is indistinguishable under chosen plaintext atack, or simply CPA-secure, if for any efficient <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi mathvariant=script>E</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Adv_{\mathcal{E}}(\mathcal{A})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span></span></span></span> is negligible.<p>Note that every CPA-secure scheme should be probabilistic!<br> If scheme is deterministic, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> can just query <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>m</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>m_0, m_1</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>.<h3 id=CPA-security-for-Multiple-Encryptions>CPA-security for Multiple Encryptions</h3><p>We can extend CPA-security definition to the case of multiple encryptions.<br> Instead of single challenge ciphertext <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>c</mi></mrow><annotation encoding=application/x-tex>c</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">c</span></span></span></span>, adversary now get lists of challenge ciphertexts, using lists of plaintexts.<p><img alt="CPA indistinguishability experiments for multiple encryptions" src=cpa_indistinguishability_multiple.png><p>We now give the adversary access to left-or-right oracle <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>L</mi><msub><mi>R</mi><mrow><mi>k</mi><mo separator=true>,</mo><mi>b</mi></mrow></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo separator=true>,</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>LR_{k,b}(\cdot, \cdot)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class="mord mathnormal">L</span><span class=mord><span class="mord mathnormal" style=margin-right:0.00773em;>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span>. The oracle, on input a pair of messages <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><msub><mi>m</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(m_0, m_1)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>, computes and returns <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>c</mi><mo>←</mo><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c \leftarrow Enc_k(m_b)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">c</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>←</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>.<br> This is stronger oracle than <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Enc_k(\cdot)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span>, because we can get <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Enc_k(m)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>)</span></span></span></span> with left-or-right oracle by querying the oracle with <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(m, m)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">m</span><span class=mclose>)</span></span></span></span>.<ol><li>A key <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>k</mi><mo>←</mo><mi>G</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding=application/x-tex>k \leftarrow Gen</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal" style=margin-right:0.03148em;>k</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>←</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">G</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span></span></span></span> is generated.<li>The adversary <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> is given oracle access to <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>L</mi><msub><mi>R</mi><mrow><mi>k</mi><mo separator=true>,</mo><mi>b</mi></mrow></msub><mo stretchy=false>(</mo><mo>⋅</mo><mo separator=true>,</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>LR_{k,b}(\cdot, \cdot)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class="mord mathnormal">L</span><span class=mord><span class="mord mathnormal" style=margin-right:0.00773em;>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord>⋅</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span>. i.e. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> can receive any number of ciphertext pairs <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><msub><mi>c</mi><mrow><mi>i</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo separator=true>,</mo><msub><mi>c</mi><mrow><mi>i</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mo stretchy=false>)</mo><mo>←</mo><mi>L</mi><msub><mi>R</mi><mrow><mi>k</mi><mo separator=true>,</mo><mi>b</mi></mrow></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mrow><mi>i</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo separator=true>,</mo><msub><mi>m</mi><mrow><mi>i</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(c_{i,0}, c_{i,1}) \leftarrow LR_{k,b}(m_{i,0}, m_{i,1})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>←</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class="mord mathnormal">L</span><span class=mord><span class="mord mathnormal" style=margin-right:0.00773em;>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> for message pairs <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><msub><mi>m</mi><mrow><mi>i</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo separator=true>,</mo><msub><mi>m</mi><mrow><mi>i</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(m_{i,0}, m_{i,1})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> of its choice.<li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> outputs a bit <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>b</mi><mo lspace=0em mathvariant=normal rspace=0em>′</mo></msup></mrow><annotation encoding=application/x-tex>b'</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7519em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7519em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>.</ol><p>The advantage of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> is defined to be <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi mathvariant=script>E</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msub><mi>P</mi><mrow><mn>0</mn><mo separator=true>,</mo><mi mathvariant=script>E</mi></mrow></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo><mo>−</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msub><mi>P</mi><mrow><mn>1</mn><mo separator=true>,</mo><mi mathvariant=script>E</mi></mrow></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo><mi mathvariant=normal>∣</mi></mrow><annotation encoding=application/x-tex>Adv_{\mathcal{E}}(\mathcal{A}) = |\Pr[EXP_{0, \mathcal{E}}(\mathcal{A}) = 1] - \Pr[EXP_{1, \mathcal{E}}(\mathcal{A}) = 1]|</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class=mord>∣</span><span class=mspace style=margin-right:0.1667em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>]</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>]</span><span class=mord>∣</span></span></span></span>.<p>Def: A private-key encryption scheme <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>E</mi></mrow><annotation encoding=application/x-tex>\mathcal{E}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.08944em;>E</span></span></span></span> is CPA-secure for multiple encryptions, if for any efficient <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi mathvariant=script>E</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Adv_{\mathcal{E}}(\mathcal{A})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span></span></span></span> is negligible.<p>Since left-or-right oracle is stronger, if <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>E</mi></mrow><annotation encoding=application/x-tex>\mathcal{E}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.08944em;>E</span></span></span></span> is CPA-secure for multiple encryptions, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>E</mi></mrow><annotation encoding=application/x-tex>\mathcal{E}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.08944em;>E</span></span></span></span> is CPA-secure.<br> However, it is also known that if <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>E</mi></mrow><annotation encoding=application/x-tex>\mathcal{E}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.08944em;>E</span></span></span></span> is CPA-secure, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>E</mi></mrow><annotation encoding=application/x-tex>\mathcal{E}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.08944em;>E</span></span></span></span> is CPA-secure for multiple encryptions! (Although this is very hard to prove...)<br> Therefore, two definitions are equivalent!<details class="note no-icon"><summary><p>Proof</p></summary> <p>Let's assume that <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>E</mi></mrow><annotation encoding=application/x-tex>\mathcal{E}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.08944em;>E</span></span></span></span> is not CPA-secure for multiple encryptions, i.e. there exists an adversary <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> and non-negligible <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>ϵ</mi><mo>></mo><mn>0</mn></mrow><annotation encoding=application/x-tex>\epsilon > 0</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.5782em;vertical-align:-0.0391em;></span><span class="mord mathnormal">ϵ</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>0</span></span></span></span> such that</p> <p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>∣</mi><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msubsup><mi>P</mi><mrow><mn>0</mn><mo separator=true>,</mo><mi mathvariant=script>E</mi></mrow><mrow><mi>m</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi></mrow></msubsup><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo><mo>−</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msubsup><mi>P</mi><mrow><mn>1</mn><mo separator=true>,</mo><mi mathvariant=script>E</mi></mrow><mrow><mi>m</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi></mrow></msubsup><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo><mi mathvariant=normal>∣</mi><mo>></mo><mi>ϵ</mi><mi mathvariant=normal>.</mi></mrow><annotation encoding=application/x-tex>|\Pr[EXP_{0, \mathcal{E}}^{multi}(\mathcal{A}) = 1] - \Pr[EXP_{1, \mathcal{E}}^{multi}(\mathcal{A}) = 1]| > \epsilon. </annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.2822em;vertical-align:-0.3831em;></span><span class=mord>∣</span><span class=mspace style=margin-right:0.1667em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8991em;><span style=top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">lt</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.3831em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>]</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1.2822em;vertical-align:-0.3831em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8991em;><span style=top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">lt</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.3831em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>]</span><span class=mord>∣</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">ϵ</span><span class=mord>.</span></span></span></span></span></p> <p>Let <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>Q</mi></mrow><annotation encoding=application/x-tex>Q</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8778em;vertical-align:-0.1944em;></span><span class="mord mathnormal">Q</span></span></span></span> is the total number of queries that <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> asks.<br> We define the hybrid experimetns <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>H_i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> for <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>0</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>Q</mi></mrow><annotation encoding=application/x-tex>0 \leq i \leq Q</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7804em;vertical-align:-0.136em;></span><span class=mord>0</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7955em;vertical-align:-0.136em;></span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.8778em;vertical-align:-0.1944em;></span><span class="mord mathnormal">Q</span></span></span></span>, where <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>H_i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> gives <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mn>0</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Enc_k(m_0)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> for <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6595em;></span><span class="mord mathnormal">i</span></span></span></span> queries, then gives <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Enc_k(m_1)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> for the remaining <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>Q</mi><mo>−</mo><mi>i</mi></mrow><annotation encoding=application/x-tex>Q-i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8778em;vertical-align:-0.1944em;></span><span class="mord mathnormal">Q</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.6595em;></span><span class="mord mathnormal">i</span></span></span></span> queries.<br> Let <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mo><mi mathvariant=normal>≔</mi></mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msubsup><mi>P</mi><mrow><msub><mi>H</mi><mi>i</mi></msub><mo separator=true>,</mo><mi mathvariant=script>E</mi></mrow><mrow><mi>m</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi></mrow></msubsup><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><annotation encoding=application/x-tex>p_i \coloneqq \Pr[EXP_{H_i, \mathcal{E}}^{multi}(\mathcal{A}) = 1]</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel><span class=mrel><span class=mop style=position:relative;top:-0.0347em;>:</span></span><span class=mrel><span class=mspace style=margin-right:-0.0667em;></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.2605em;vertical-align:-0.4114em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8491em;><span style=top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.08125em;>H</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3281em;><span style=top:-2.357em;margin-left:-0.0813em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.143em;><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">lt</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.4114em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>]</span></span></span></span>.</p> <p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mtable columnalign="right left" columnspacing=0em rowspacing=0.25em><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi mathvariant=script>E</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mi mathvariant=normal>∣</mi><msub><mi>p</mi><mi>Q</mi></msub><mo>−</mo><msub><mi>p</mi><mn>0</mn></msub><mi mathvariant=normal>∣</mi></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>≤</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>Q</mi></munderover><mi mathvariant=normal>∣</mi><msub><mi>p</mi><mi>i</mi></msub><mo>−</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant=normal>∣</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mo>∴</mo><mi mathvariant=normal>∃</mi><mi>j</mi><mo stretchy=false>(</mo><mn>1</mn><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>Q</mi><mo stretchy=false>)</mo><mtext> </mtext><mi>s</mi><mi mathvariant=normal>.</mi><mi>t</mi><mi mathvariant=normal>.</mi><mtext> </mtext></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mi mathvariant=normal>∣</mi><msub><mi>p</mi><mi>j</mi></msub><mo>−</mo><msub><mi>p</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant=normal>∣</mi><mo>></mo><mfrac><mi>ϵ</mi><mi>Q</mi></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{align*} Adv_{\mathcal{E}}(\mathcal{A}) = |p_Q - p_0| &\leq \sum_{i = 1}^Q |p_i - p_{i-1}| \\ \therefore \exists j (1 \leq j \leq Q) \ s.t. \ & |p_j - p_{j-1}| > \frac{\epsilon}{Q} \end{align*}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:5.7411em;vertical-align:-2.6206em;></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.1206em;><span style=top:-5.1206em;><span class=pstrut style=height:3.8754em;></span><span class=mord><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>∣</span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mord>∣</span></span></span><span style=top:-2.4353em;><span class=pstrut style=height:3.8754em;></span><span class=mord><span class="mrel amsrm">∴</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>∃</span><span class="mord mathnormal" style=margin-right:0.05724em;>j</span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span><span class="mord mathnormal" style=margin-right:0.05724em;>j</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span><span class="mord mathnormal">Q</span><span class=mclose>)</span><span class=mspace> </span><span class="mord mathnormal">s</span><span class=mord>.</span><span class="mord mathnormal">t</span><span class=mord>.</span><span class=mspace> </span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.6206em;><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.1206em;><span style=top:-5.1206em;><span class=pstrut style=height:3.8754em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8754em;><span style=top:-1.8723em;margin-left:0em;><span class=pstrut style=height:3.05em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em;><span class=pstrut style=height:3.05em;></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=top:-4.3471em;margin-left:0em;><span class=pstrut style=height:3.05em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2777em;><span></span></span></span></span></span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>∣</span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2083em;><span></span></span></span></span></span></span><span class=mord>∣</span></span></span><span style=top:-2.4353em;><span class=pstrut style=height:3.8754em;></span><span class=mord><span class=mord></span><span class=mord>∣</span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mord>∣</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>></span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.1076em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class="mord mathnormal">Q</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class="mord mathnormal">ϵ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.8804em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.6206em;><span></span></span></span></span></span></span></span></span></span></span></span></p> <p>Now we define adversaries <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>B</mi><mi mathvariant=script>i</mi></msub></mrow><annotation encoding=application/x-tex>\mathcal{B_i}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0304em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> (<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>Q</mi></mrow><annotation encoding=application/x-tex>1 \leq i \leq Q</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7804em;vertical-align:-0.136em;></span><span class=mord>1</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7955em;vertical-align:-0.136em;></span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.8778em;vertical-align:-0.1944em;></span><span class="mord mathnormal">Q</span></span></span></span>) for CPA-secure experiment.</p> <ol><li>Get queries <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><msub><mi>m</mi><mrow><mi>j</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo separator=true>,</mo><msub><mi>m</mi><mrow><mi>j</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(m_{j,0}, m_{j,1})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> from <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>.<li>For <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>j</mi><mo>&lt;</mo><mi>i</mi></mrow><annotation encoding=application/x-tex>j &lt; i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.854em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.05724em;>j</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6595em;></span><span class="mord mathnormal">i</span></span></span></span>, give <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mrow><mi>j</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Enc_k(m_{j,0})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> to <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>.<li>For <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>j</mi><mo>=</mo><mi>i</mi></mrow><annotation encoding=application/x-tex>j = i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.854em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.05724em;>j</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6595em;></span><span class="mord mathnormal">i</span></span></span></span>, output <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><msub><mi>m</mi><mrow><mi>j</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo separator=true>,</mo><msub><mi>m</mi><mrow><mi>j</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(m_{j,0}, m_{j,1})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> as a challenge pair, and give the result <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>c</mi></mrow><annotation encoding=application/x-tex>c</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">c</span></span></span></span> to <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>.<li>For <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>j</mi><mo>></mo><mi>i</mi></mrow><annotation encoding=application/x-tex>j > i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.854em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.05724em;>j</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6595em;></span><span class="mord mathnormal">i</span></span></span></span>, give <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mrow><mi>j</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Enc_k(m_{j,1})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> to <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>.<li>Get <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>b</mi><mo lspace=0em mathvariant=normal rspace=0em>′</mo></msup></mrow><annotation encoding=application/x-tex>b'</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7519em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7519em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> from <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>, and output <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>b</mi><mo lspace=0em mathvariant=normal rspace=0em>′</mo></msup></mrow><annotation encoding=application/x-tex>b'</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7519em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7519em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>.</ol> <p>If <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>b = 0</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal">b</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>0</span></span></span></span> (i.e. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>c</mi><mo>=</mo><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mrow><mi>i</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c = Enc_k(m_{i,0})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">c</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>), this is a <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>H_i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> experiment from <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>'s point of view.</p> <p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo>∴</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msubsup><mi>P</mi><mrow><mn>0</mn><mo separator=true>,</mo><mi mathvariant=script>E</mi></mrow><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>l</mi><mi>e</mi></mrow></msubsup><mo stretchy=false>(</mo><msub><mi mathvariant=script>B</mi><mi mathvariant=script>i</mi></msub><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo><mo>=</mo><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>\therefore \Pr[EXP_{0, \mathcal{E}}^{single}(\mathcal{B_i}) = 1] = p_i </annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6922em;></span><span class="mrel amsrm">∴</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.3967em;vertical-align:-0.4296em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.967em;><span style=top:-2.4065em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span><span style=top:-3.1809em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight" style=margin-right:0.03588em;>g</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.4296em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0304em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>]</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span></span></p> <p>If <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>b = 1</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal">b</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>1</span></span></span></span> (i.e. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>c</mi><mo>=</mo><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mrow><mi>i</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c = Enc_k(m_{i,1})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">c</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>), this is a <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>H</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=application/x-tex>H_{i-1}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8917em;vertical-align:-0.2083em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2083em;><span></span></span></span></span></span></span></span></span></span> experiment from <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>'s point of view.</p> <p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo>∴</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msubsup><mi>P</mi><mrow><mn>1</mn><mo separator=true>,</mo><mi mathvariant=script>E</mi></mrow><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>l</mi><mi>e</mi></mrow></msubsup><mo stretchy=false>(</mo><msub><mi mathvariant=script>B</mi><mi mathvariant=script>i</mi></msub><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo><mo>=</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=application/x-tex>\therefore \Pr[EXP_{1, \mathcal{E}}^{single}(\mathcal{B_i}) = 1] = p_{i-1} </annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6922em;></span><span class="mrel amsrm">∴</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.3967em;vertical-align:-0.4296em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.967em;><span style=top:-2.4065em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span><span style=top:-3.1809em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight" style=margin-right:0.03588em;>g</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.4296em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0304em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>]</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6389em;vertical-align:-0.2083em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2083em;><span></span></span></span></span></span></span></span></span></span></span></p> <p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mtable columnalign="right left" columnspacing=0em rowspacing=0.25em><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>∴</mo><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi mathvariant=script>E</mi></msub><mo stretchy=false>(</mo><msub><mi mathvariant=script>B</mi><mi mathvariant=script>i</mi></msub><mo stretchy=false>)</mo><mo>=</mo><mi mathvariant=normal>∣</mi><msub><mi>p</mi><mi>i</mi></msub><mo>−</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant=normal>∣</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>∴</mo><mi mathvariant=normal>∃</mi><mi>j</mi><mo stretchy=false>(</mo><mn>1</mn><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>Q</mi><mo stretchy=false>)</mo><mtext> </mtext><mi>s</mi><mi mathvariant=normal>.</mi><mi>t</mi><mi mathvariant=normal>.</mi><mtext> </mtext><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi mathvariant=script>E</mi></msub><mo stretchy=false>(</mo><msub><mi mathvariant=script>B</mi><mi mathvariant=script>j</mi></msub><mo stretchy=false>)</mo><mo>></mo><mfrac><mi>ϵ</mi><mi>Q</mi></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{align*} &\therefore Adv_{\mathcal{E}}(\mathcal{B_i}) = |p_i - p_{i-1}| \\ &\therefore \exists j (1 \leq j \leq Q) \ s.t. \ Adv_{\mathcal{E}}(\mathcal{B_j}) > \frac{\epsilon}{Q} \end{align*}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:3.788em;vertical-align:-1.644em;></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.144em;><span style=top:-4.4116em;><span class=pstrut style=height:3.1076em;></span><span class=mord></span></span><span style=top:-2.644em;><span class=pstrut style=height:3.1076em;></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.644em;><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.144em;><span style=top:-4.4116em;><span class=pstrut style=height:3.1076em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class="mrel amsrm">∴</span><span class=mspace style=margin-right:0.2778em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0304em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>∣</span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2083em;><span></span></span></span></span></span></span><span class=mord>∣</span></span></span><span style=top:-2.644em;><span class=pstrut style=height:3.1076em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class="mrel amsrm">∴</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>∃</span><span class="mord mathnormal" style=margin-right:0.05724em;>j</span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span><span class="mord mathnormal" style=margin-right:0.05724em;>j</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span><span class="mord mathnormal">Q</span><span class=mclose>)</span><span class=mspace> </span><span class="mord mathnormal">s</span><span class=mord>.</span><span class="mord mathnormal">t</span><span class=mord>.</span><span class=mspace> </span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0304em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>></span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.1076em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class="mord mathnormal">Q</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class="mord mathnormal">ϵ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.8804em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.644em;><span></span></span></span></span></span></span></span></span></span></span></span></p> <p>Therefore, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>B</mi><mi mathvariant=script>j</mi></msub></mrow><annotation encoding=application/x-tex>\mathcal{B_j}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.9694em;vertical-align:-0.2861em;></span><span class=mord><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:-0.0304em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05724em;>j</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span></span></span></span> can distinguish <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>E</mi></mrow><annotation encoding=application/x-tex>\mathcal{E}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.08944em;>E</span></span></span></span> under chosen plaintext attack with a non-negligible probability <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mfrac><mi>ϵ</mi><mi>Q</mi></mfrac></mrow><annotation encoding=application/x-tex>\frac{\epsilon}{Q}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.1765em;vertical-align:-0.4811em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.6954em;><span style=top:-2.655em;><span class=pstrut style=height:3em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Q</span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.394em;><span class=pstrut style=height:3em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.4811em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>.</p> <p>Since <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>E</mi></mrow><annotation encoding=application/x-tex>\mathcal{E}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.08944em;>E</span></span></span></span> is not CPA-secure if it is not CPA-secure for multiple encryptions, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>E</mi></mrow><annotation encoding=application/x-tex>\mathcal{E}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.08944em;>E</span></span></span></span> is CPA-secure for multiple encryptions if <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>E</mi></mrow><annotation encoding=application/x-tex>\mathcal{E}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.08944em;>E</span></span></span></span> is CPA-secure.</p></details><h3 id=plaintext-length>plaintext length</h3><p>Definition of secure encryptions does not require the encryption scheme to hide the plaintext length!<br> All commonly used encryption schemes reveal the plaintext length (or a close approximation).<br> c.f. If the encryption scheme doesn't hide the plaintext length, the adversary must choose messages of the same length in the security game.<p>It is impossible to support arbitrary length messages while hiding all information about the plaintext length. (However encryption scheme can hide the exact length, while revealing an approximation.)<br> This is due to information theory, a set of arbitrary length plaintext is larger than a set of fixed length ciphertext. (The ciphertext has fixed length because we obviously know its length when we receive it.)<p>In many cases, revealing the plaintext length is acceptable as it is already public or is not sensitive.<br> However, leaking the plaintext length can be problematic in some cases. (e.g. simple numberic/text data, compression)<p>Solution: Pad all messages to some pre-determined length before encrypting them.<br> e.g. append 1 followed by several 0's. (message and plaintext have one-to-one correspondence!)<br> Now the plaintext's length is fixed and known to the adversary, but we can't get "actual" length of the message!<p>Note that due to information theory, padded message should be longer than previous message. We cannot have one-to-one correspondence between <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mo>⋃</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mi>i</mi></msup></mrow><annotation encoding=application/x-tex>\bigcup_{i=1}^n \{0, 1\}^i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.1244em;vertical-align:-0.2997em;></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0em;>⋃</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8043em;><span style=top:-2.4003em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.2029em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2997em;><span></span></span></span></span></span></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8247em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>\{ 0, 1 \}^n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6644em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>.<h2 id=CPA-security-from-PRF>CPA security from PRF</h2><p>Recall) Block cipher cannot be CPA secure! (Because block ciphertext is deterministic!)<br> e.g. Block cipher will encrypt sex data (man/woman) into <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>c</mi><mi>m</mi></msub></mrow><annotation encoding=application/x-tex>c_m</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> or <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>c</mi><mi>w</mi></msub></mrow><annotation encoding=application/x-tex>c_w</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.02691em;>w</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>... Encryption is meaningless!<br> If your security company claims that they encrypted data using a plain block cipher (e.g. AES), don't believe them...<br> But we want to use block cipher.... How do we make CPA-secure scheme with block cipher?<p>Let <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>F</mi><mo>:</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mi>n</mi></msup><mo>×</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mi>l</mi></msup><mo>→</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mi>l</mi></msup></mrow><annotation encoding=application/x-tex>F: \{ 0, 1 \}^n \times \{ 0, 1 \}^l \rightarrow \{ 0, 1 \}^l</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.13889em;>F</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>:</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6644em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>×</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1.0991em;vertical-align:-0.25em;></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8491em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>→</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0991em;vertical-align:-0.25em;></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8491em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span></span></span></span></span></span></span></span></span></span></span> be a PRF. Then we can make a construction <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>E</mi><mo>=</mo><mo stretchy=false>(</mo><mi>G</mi><mi>e</mi><mi>n</mi><mo separator=true>,</mo><mi>E</mi><mi>n</mi><mi>c</mi><mo separator=true>,</mo><mi>D</mi><mi>e</mi><mi>c</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\mathcal{E} = (Gen, Enc, Dec)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.08944em;>E</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class="mord mathnormal">G</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">Dec</span><span class=mclose>)</span></span></span></span>:<ul><li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>G</mi><mi>e</mi><mi>n</mi></mrow><annotation encoding=application/x-tex>Gen</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">G</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span></span></span></span>: Choose uniform <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>k</mi><mo>∈</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>k \in \{ 0, 1 \}^n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7335em;vertical-align:-0.0391em;></span><span class="mord mathnormal" style=margin-right:0.03148em;>k</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6644em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>.<li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Enc_k(m)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>)</span></span></span></span>: On input a key <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>k</mi><mo>∈</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>k \in \{ 0, 1 \}^n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7335em;vertical-align:-0.0391em;></span><span class="mord mathnormal" style=margin-right:0.03148em;>k</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6644em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> and a message <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>m</mi><mo>∈</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mi>l</mi></msup></mrow><annotation encoding=application/x-tex>m \in \{ 0, 1 \}^l</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.5782em;vertical-align:-0.0391em;></span><span class="mord mathnormal">m</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0991em;vertical-align:-0.25em;></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8491em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span></span></span></span></span></span></span></span></span></span></span>, choose uniform <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>r</mi><mo>∈</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mi>l</mi></msup></mrow><annotation encoding=application/x-tex>r \in \{ 0, 1 \}^l</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.5782em;vertical-align:-0.0391em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0991em;vertical-align:-0.25em;></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8491em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span></span></span></span></span></span></span></span></span></span></span> and output the ciphertext <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>c</mi><mo><mi mathvariant=normal>≔</mi></mo><mo stretchy=false>(</mo><mi>r</mi><mo separator=true>,</mo><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>r</mi><mo stretchy=false>)</mo><mo>⊕</mo><mi>m</mi><mo stretchy=false>)</mo><mo>∈</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mrow><mn>2</mn><mi>l</mi></mrow></msup></mrow><annotation encoding=application/x-tex>c \coloneqq (r, F_k(r) \oplus m) \in \{ 0, 1 \}^{2l}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">c</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel><span class=mrel><span class=mop style=position:relative;top:-0.0347em;>:</span></span><span class=mrel><span class=mspace style=margin-right:-0.0667em;></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⊕</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal">m</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0991em;vertical-align:-0.25em;></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8491em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span></span></span></span></span></span></span></span></span></span></span></span>.<li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>D</mi><mi>e</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>c</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Dec_k(c)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal">De</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">c</span><span class=mclose>)</span></span></span></span>: On input a key <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>k</mi><mo>∈</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><msup><mo stretchy=false>}</mo><mi>n</mi></msup></mrow><annotation encoding=application/x-tex>k \in \{ 0, 1 \}^n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7335em;vertical-align:-0.0391em;></span><span class="mord mathnormal" style=margin-right:0.03148em;>k</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span><span class=mclose><span class=mclose>}</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6644em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> and a ciphertext <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>c</mi><mo>=</mo><mo stretchy=false>(</mo><mi>r</mi><mo separator=true>,</mo><mi>s</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c = (r, s)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">c</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">s</span><span class=mclose>)</span></span></span></span>, output the message <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>m</mi><mo><mi mathvariant=normal>≔</mi></mo><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>r</mi><mo stretchy=false>)</mo><mo>⊕</mo><mi>s</mi></mrow><annotation encoding=application/x-tex>m \coloneqq F_k(r) \oplus s</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">m</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel><span class=mrel><span class=mop style=position:relative;top:-0.0347em;>:</span></span><span class=mrel><span class=mspace style=margin-right:-0.0667em;></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⊕</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">s</span></span></span></span>.</ul><p>Theorem: For any <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>q</span></span></span></span>-query adversary <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>, there exists a <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>q</span></span></span></span>-query adversary <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>B</mi></mrow><annotation encoding=application/x-tex>\mathcal{B}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.03041em;>B</span></span></span></span> such that <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi mathvariant=script>E</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>≤</mo><mn>2</mn><mo>⋅</mo><mrow><mo fence=true>(</mo><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi>F</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>B</mi><mo stretchy=false>)</mo><mo>+</mo><mfrac><mi>q</mi><msup><mn>2</mn><mi>l</mi></msup></mfrac><mo fence=true>)</mo></mrow></mrow><annotation encoding=application/x-tex>Adv_{\mathcal{E}}(\mathcal{A}) \leq 2 \cdot \left( Adv_F(\mathcal{B}) + \frac{q}{2^l} \right)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>2</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1.2074em;vertical-align:-0.3574em;></span><span class=minner><span class="mopen delimcenter" style=top:0em;><span class="delimsizing size1">(</span></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>F</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.7475em;><span style=top:-2.6426em;><span class=pstrut style=height:3em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.782em;><span style=top:-2.786em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.4461em;><span class=pstrut style=height:3em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.03588em;>q</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.3574em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style=top:0em;><span class="delimsizing size1">)</span></span></span></span></span></span>.<br> i.e. If F is secure PRF, then the construction is CPA-secure!<details class="note no-icon"><summary><p>Proof</p></summary> <p>Let <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> is an adversary for the CPA indistinguishability experiment.<br> We define an adversary <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>B</mi></mrow><annotation encoding=application/x-tex>\mathcal{B}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.03041em;>B</span></span></span></span> for PRF experiment.</p> <ol><li>For each query <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">m</span></span></span></span> from <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>, generate uniformly random <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>l</mi></mrow><annotation encoding=application/x-tex>l</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal" style=margin-right:0.01968em;>l</span></span></span></span> bit string <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span></span></span></span>, query <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>y</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>y_r</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em;>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> (<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>B</mi></mrow><annotation encoding=application/x-tex>\mathcal{B}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.03041em;>B</span></span></span></span> gets either <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>r</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>F_k(r)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mclose>)</span></span></span></span> or <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>f</mi><mo stretchy=false>(</mo><mi>r</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>f(r)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.10764em;>f</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mclose>)</span></span></span></span>), then give <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>c</mi><mo>=</mo><mo stretchy=false>(</mo><mi>r</mi><mo separator=true>,</mo><msub><mi>y</mi><mi>r</mi></msub><mo>⊕</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c = (r, y_r \oplus m)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">c</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em;>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⊕</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal">m</span><span class=mclose>)</span></span></span></span> to <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>.<li>For challenge query <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><msub><mi>m</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(m_0, m_1)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> from <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>, generate random bit <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>b</mi><mo>∈</mo><mo stretchy=false>{</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo stretchy=false>}</mo></mrow><annotation encoding=application/x-tex>b \in \{ 0, 1 \}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7335em;vertical-align:-0.0391em;></span><span class="mord mathnormal">b</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>{</span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>1</span><span class=mclose>}</span></span></span></span> and random <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>l</mi></mrow><annotation encoding=application/x-tex>l</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal" style=margin-right:0.01968em;>l</span></span></span></span> bit string <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>r</mi><mo>∗</mo></msup></mrow><annotation encoding=application/x-tex>r^*</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6887em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6887em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>, query <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>y</mi><msup><mi>r</mi><mo>∗</mo></msup></msub></mrow><annotation encoding=application/x-tex>y_{r^*}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.2828em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em;>r</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6183em;><span style=top:-2.786em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>, then give <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>c</mi><mi>b</mi></msub><mo>=</mo><mo stretchy=false>(</mo><msup><mi>r</mi><mo>∗</mo></msup><mo separator=true>,</mo><msub><mi>y</mi><msup><mi>r</mi><mo>∗</mo></msup></msub><mo>⊕</mo><msub><mi>m</mi><mi>b</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c_b = (r^*, y_{r^*} \oplus m_b)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6887em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.2828em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em;>r</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6183em;><span style=top:-2.786em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⊕</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> to <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>.<li>Get the output <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>b</mi><mo lspace=0em mathvariant=normal rspace=0em>′</mo></msup></mrow><annotation encoding=application/x-tex>b'</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7519em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7519em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> from <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>.<li>If <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>b</mi><mo>=</mo><msup><mi>b</mi><mo lspace=0em mathvariant=normal rspace=0em>′</mo></msup></mrow><annotation encoding=application/x-tex>b = b'</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal">b</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7519em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7519em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> (i.e. adversary was correct), output 0 (i.e. this was a PRF).<li>If <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>b</mi><mo mathvariant=normal>≠</mo><msup><mi>b</mi><mo lspace=0em mathvariant=normal rspace=0em>′</mo></msup></mrow><annotation encoding=application/x-tex>b \neq b'</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8889em;vertical-align:-0.1944em;></span><span class="mord mathnormal">b</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel><span class=mrel><span class="mord vbox"><span class=thinbox><span class=rlap><span class=strut style=height:0.8889em;vertical-align:-0.1944em;></span><span class=inner><span class=mord><span class=mrel></span></span></span><span class=fix></span></span></span></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7519em;></span><span class=mord><span class="mord mathnormal">b</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7519em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> (i.e. adversary was wrong), output 1 (i.e. this was a random function).</ol> <p>Let <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>p</mi><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mi>b</mi></mrow></msub><mo><mi mathvariant=normal>≔</mi></mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msub><mi>P</mi><mrow><mi>b</mi><mo separator=true>,</mo><mi mathvariant=script>E</mi></mrow></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><annotation encoding=application/x-tex>p_{\mathcal{A},b} \coloneqq \Pr[EXP_{b, \mathcal{E}}(\mathcal{A}) = 1]</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7167em;vertical-align:-0.2861em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel><span class=mrel><span class=mop style=position:relative;top:-0.0347em;>:</span></span><span class=mrel><span class=mspace style=margin-right:-0.0667em;></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mpunct mtight">,</span><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>]</span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>p</mi><mrow><mi mathvariant=script>B</mi><mo separator=true>,</mo><mi>b</mi></mrow></msub><mo><mi mathvariant=normal>≔</mi></mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msub><mi>P</mi><mrow><mi>b</mi><mo separator=true>,</mo><mi>F</mi></mrow></msub><mo stretchy=false>(</mo><mi mathvariant=script>B</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo></mrow><annotation encoding=application/x-tex>p_{\mathcal{B},b} \coloneqq \Pr[EXP_{b, F}(\mathcal{B}) = 1]</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7167em;vertical-align:-0.2861em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.03041em;>B</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel><span class=mrel><span class=mop style=position:relative;top:-0.0347em;>:</span></span><span class=mrel><span class=mspace style=margin-right:-0.0667em;></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style=margin-right:0.13889em;>F</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>]</span></span></span></span>.</p> <p>If this was a experiment 0 (i.e. PRF was given), this is same experiment from <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span>'s point of view.</p> <p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mtable columnalign="right left" columnspacing=0em rowspacing=0.25em><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mo>∴</mo><msub><mi>p</mi><mrow><mi mathvariant=script>B</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>b</mi><mo>=</mo><mn>0</mn><mo stretchy=false>]</mo><mo>⋅</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msub><mi>P</mi><mrow><mn>0</mn><mo separator=true>,</mo><mi mathvariant=script>E</mi></mrow></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo><mo>+</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>b</mi><mo>=</mo><mn>1</mn><mo stretchy=false>]</mo><mo>⋅</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><mi>E</mi><mi>X</mi><msub><mi>P</mi><mrow><mn>1</mn><mo separator=true>,</mo><mi mathvariant=script>E</mi></mrow></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>=</mo><mn>0</mn><mo stretchy=false>]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⋅</mo><msub><mi>p</mi><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⋅</mo><mo stretchy=false>(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⋅</mo><mo stretchy=false>(</mo><msub><mi>p</mi><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo>−</mo><msub><mi>p</mi><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{align*} \therefore p_{\mathcal{B},0} &= \Pr[b = 0] \cdot \Pr[EXP_{0, \mathcal{E}}(\mathcal{A}) = 1] + \Pr[b = 1] \cdot \Pr[EXP_{1, \mathcal{E}}(\mathcal{A}) = 0] \\ &= \frac{1}{2} \cdot p_{\mathcal{A},0} + \frac{1}{2} \cdot (1 - p_{\mathcal{A},1}) \\ &= \frac{1}{2} + \frac{1}{2} \cdot (p_{\mathcal{A},0} - p_{\mathcal{A},1}) \end{align*}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:6.1149em;vertical-align:-2.8074em;></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.3074em;><span style=top:-5.7889em;><span class=pstrut style=height:3.3214em;></span><span class=mord><span class="mrel amsrm">∴</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.03041em;>B</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span></span></span><span style=top:-3.8074em;><span class=pstrut style=height:3.3214em;></span><span class=mord></span></span><span style=top:-1.5em;><span class=pstrut style=height:3.3214em;></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.8074em;><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.3074em;><span style=top:-5.7889em;><span class=pstrut style=height:3.3214em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal">b</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>0</span><span class=mclose>]</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>1</span><span class=mclose>]</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal">b</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>1</span><span class=mclose>]</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class="mord mathnormal" style=margin-right:0.07847em;>EX</span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>0</span><span class=mclose>]</span></span></span><span style=top:-3.8074em;><span class=pstrut style=height:3.3214em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.686em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.686em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span><span class=mopen>(</span><span class=mord>1</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span><span style=top:-1.5em;><span class=pstrut style=height:3.3214em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.686em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.686em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.8074em;><span></span></span></span></span></span></span></span></span></span></span></span></p> <p>If this was a experiment 1 (i.e. random function was given), <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>y</mi><msup><mi>r</mi><mo>∗</mo></msup></msub><mo>⊕</mo><msub><mi>m</mi><mi>b</mi></msub></mrow><annotation encoding=application/x-tex>y_{r^*} \oplus m_b</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7778em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.2828em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.02778em;>r</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6183em;><span style=top:-2.786em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⊕</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> is a random string. Therefore, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> cannot distinguish <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>c</mi><mn>0</mn></msub><mo separator=true>,</mo><msub><mi>c</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>c_0, c_1</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> unless <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>r</mi><mo>∗</mo></msup></mrow><annotation encoding=application/x-tex>r^*</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6887em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6887em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> is the same as <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>r</span></span></span></span> from one of the other queries.</p> <p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo>∴</mo><mrow><mo fence=true>∣</mo><msub><mi>p</mi><mrow><mi mathvariant=script>B</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo fence=true>∣</mo></mrow><mo>≤</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=false>[</mo><msup><mi>r</mi><mo>∗</mo></msup><mo>∈</mo><mo stretchy=false>{</mo><msub><mi>r</mi><mn>1</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>r</mi><mi>q</mi></msub><mo stretchy=false>}</mo><mo stretchy=false>]</mo><mo>≤</mo><mfrac><mi>q</mi><msup><mn>2</mn><mi>l</mi></msup></mfrac></mrow><annotation encoding=application/x-tex>\therefore \left| p_{\mathcal{B},1} - \frac{1}{2} \right| \leq \Pr[r^* \in \{ r_1, \ldots, r_q \}] \leq \frac{q}{2^l} </annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6922em;></span><span class="mrel amsrm">∴</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:2.4em;vertical-align:-0.95em;></span><span class=minner><span class=mopen><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em;><span style=top:-3.45em;><span class=pstrut style=height:4.4em;></span><span style=width:0.333em;height:2.400em;><svg viewbox="0 0 333 2400" height=2.400em width=0.333em xmlns=http://www.w3.org/2000/svg><path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.95em;><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.03041em;>B</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.686em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em;><span style=top:-3.45em;><span class=pstrut style=height:4.4em;></span><span style=width:0.333em;height:2.400em;><svg viewbox="0 0 333 2400" height=2.400em width=0.333em xmlns=http://www.w3.org/2000/svg><path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.95em;><span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mop>Pr</span><span class=mopen>[</span><span class=mord><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7387em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>∈</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.0361em;vertical-align:-0.2861em;></span><span class=mopen>{</span><span class=mord><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=minner>…</span><span class=mspace style=margin-right:0.1667em;></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.02778em;>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.1514em;><span style=top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03588em;>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mclose>}]</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.7936em;vertical-align:-0.686em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.1076em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7751em;><span style=top:-2.989em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.686em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p> <p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mtable columnalign="right left" columnspacing=0em rowspacing=0.25em><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mo>∵</mo><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi>F</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>B</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mi mathvariant=normal>∣</mi><msub><mi>p</mi><mrow><mi mathvariant=script>B</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo>−</mo><msub><mi>p</mi><mrow><mi mathvariant=script>B</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mi mathvariant=normal>∣</mi><mo separator=true>,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mo fence=true>∣</mo><msub><mi>p</mi><mrow><mi mathvariant=script>B</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo fence=true>∣</mo></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>≤</mo><mi mathvariant=normal>∣</mi><msub><mi>p</mi><mrow><mi mathvariant=script>B</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo>−</mo><msub><mi>p</mi><mrow><mi mathvariant=script>B</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mi mathvariant=normal>∣</mi><mo>+</mo><mrow><mo fence=true>∣</mo><msub><mi>p</mi><mrow><mi mathvariant=script>B</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo fence=true>∣</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>≤</mo><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi>F</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>B</mi><mo stretchy=false>)</mo><mo>+</mo><mfrac><mi>q</mi><msup><mn>2</mn><mi>l</mi></msup></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mo>∴</mo><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi mathvariant=script>E</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mi mathvariant=normal>∣</mi><msub><mi>p</mi><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo>−</mo><msub><mi>p</mi><mrow><mi mathvariant=script>A</mi><mo separator=true>,</mo><mn>1</mn></mrow></msub><mi mathvariant=normal>∣</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mn>2</mn><mo>⋅</mo><mrow><mo fence=true>∣</mo><msub><mi>p</mi><mrow><mi mathvariant=script>B</mi><mo separator=true>,</mo><mn>0</mn></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo fence=true>∣</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>≤</mo><mn>2</mn><mo>⋅</mo><mrow><mo fence=true>(</mo><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi>F</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>B</mi><mo stretchy=false>)</mo><mo>+</mo><mfrac><mi>q</mi><msup><mn>2</mn><mi>l</mi></msup></mfrac><mo fence=true>)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{align*} \because Adv_F(\mathcal{B}) &= |p_{\mathcal{B},0} - p_{\mathcal{B},1}|, \\ \left| p_{\mathcal{B},0} - \frac{1}{2} \right| &\leq |p_{\mathcal{B},0} - p_{\mathcal{B},1}| + \left| p_{\mathcal{B},1} - \frac{1}{2} \right| \\ &\leq Adv_F(\mathcal{B}) + \frac{q}{2^l} \\ \therefore Adv_{\mathcal{E}}(\mathcal{A}) &= |p_{\mathcal{A},0} - p_{\mathcal{A},1}| \\ &= 2 \cdot \left| p_{\mathcal{B},0} - \frac{1}{2} \right| \\ &\leq 2 \cdot \left( Adv_F(\mathcal{B}) + \frac{q}{2^l} \right) \end{align*}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:12.6296em;vertical-align:-6.0648em;></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:6.5648em;><span style=top:-9.1748em;><span class=pstrut style=height:3.45em;></span><span class=mord><span class="mrel amsrm">∵</span><span class=mspace style=margin-right:0.2778em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>F</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=mclose>)</span></span></span><span style=top:-7.0648em;><span class=pstrut style=height:3.45em;></span><span class=mord><span class=minner><span class=mopen><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em;><span style=top:-3.45em;><span class=pstrut style=height:4.4em;></span><span style=width:0.333em;height:2.400em;><svg viewbox="0 0 333 2400" height=2.400em width=0.333em xmlns=http://www.w3.org/2000/svg><path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.95em;><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.03041em;>B</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.686em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em;><span style=top:-3.45em;><span class=pstrut style=height:4.4em;></span><span style=width:0.333em;height:2.400em;><svg viewbox="0 0 333 2400" height=2.400em width=0.333em xmlns=http://www.w3.org/2000/svg><path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.95em;><span></span></span></span></span></span></span></span></span></span><span style=top:-4.7072em;><span class=pstrut style=height:3.45em;></span><span class=mord></span></span><span style=top:-2.8812em;><span class=pstrut style=height:3.45em;></span><span class=mord><span class="mrel amsrm">∴</span><span class=mspace style=margin-right:0.2778em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span></span></span><span style=top:-0.7712em;><span class=pstrut style=height:3.45em;></span><span class=mord></span></span><span style=top:1.6288em;><span class=pstrut style=height:3.45em;></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:6.0648em;><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:6.5648em;><span style=top:-9.1748em;><span class=pstrut style=height:3.45em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>∣</span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.03041em;>B</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.03041em;>B</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mord>∣</span><span class=mpunct>,</span></span></span><span style=top:-7.0648em;><span class=pstrut style=height:3.45em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>∣</span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.03041em;>B</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.03041em;>B</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mord>∣</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=minner><span class=mopen><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em;><span style=top:-3.45em;><span class=pstrut style=height:4.4em;></span><span style=width:0.333em;height:2.400em;><svg viewbox="0 0 333 2400" height=2.400em width=0.333em xmlns=http://www.w3.org/2000/svg><path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.95em;><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.03041em;>B</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.686em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em;><span style=top:-3.45em;><span class=pstrut style=height:4.4em;></span><span style=width:0.333em;height:2.400em;><svg viewbox="0 0 333 2400" height=2.400em width=0.333em xmlns=http://www.w3.org/2000/svg><path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.95em;><span></span></span></span></span></span></span></span></span></span><span style=top:-4.7072em;><span class=pstrut style=height:3.45em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>F</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.1076em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7751em;><span style=top:-2.989em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.686em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style=top:-2.8812em;><span class=pstrut style=height:3.45em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>∣</span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">A</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mord>∣</span></span></span><span style=top:-0.7712em;><span class=pstrut style=height:3.45em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>2</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span><span class=minner><span class=mopen><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em;><span style=top:-3.45em;><span class=pstrut style=height:4.4em;></span><span style=width:0.333em;height:2.400em;><svg viewbox="0 0 333 2400" height=2.400em width=0.333em xmlns=http://www.w3.org/2000/svg><path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.95em;><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.03041em;>B</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2861em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>2</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.686em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em;><span style=top:-3.45em;><span class=pstrut style=height:4.4em;></span><span style=width:0.333em;height:2.400em;><svg viewbox="0 0 333 2400" height=2.400em width=0.333em xmlns=http://www.w3.org/2000/svg><path d="M145 15 v585 v1200 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v-1200 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1200 v585 h43z"/></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.95em;><span></span></span></span></span></span></span></span></span></span><span style=top:1.6288em;><span class=pstrut style=height:3.45em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord>2</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span><span class=minner><span class="mopen delimcenter" style=top:0em;><span class="delimsizing size2">(</span></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>F</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.1076em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7751em;><span style=top:-2.989em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.01968em;>l</span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.686em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style=top:0em;><span class="delimsizing size2">)</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:6.0648em;><span></span></span></span></span></span></span></span></span></span></span></span></p></details><p>Problem) Expansion rate <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mfrac><mrow><mi mathvariant=normal>∣</mi><mi>C</mi><mi mathvariant=normal>∣</mi></mrow><mrow><mi mathvariant=normal>∣</mi><mi>M</mi><mi mathvariant=normal>∣</mi></mrow></mfrac></mrow><annotation encoding=application/x-tex>\frac{|C|}{|M|}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.53em;vertical-align:-0.52em;></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.01em;><span style=top:-2.655em;><span class=pstrut style=height:3em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight" style=margin-right:0.10903em;>M</span><span class="mord mtight">∣</span></span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.485em;><span class=pstrut style=height:3em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight" style=margin-right:0.07153em;>C</span><span class="mord mtight">∣</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.52em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> is not good.<br> Since CPA-secure scheme is probablistic, plaintext can be encrypted to multiple ciphertexts. (i.e. expansion rate is larger than 1.)<br> However, an expansion rate of 2 is too high...<h1>Modes of operation</h1><p>The previous construction is defined only for the encryption of fixed-length messages. Can we encrypt arbitrary-length messages?<br> We can divide a long message into multiple short messages and encrypting them one-by-one.<p>This is called <strong>mode of operation</strong>: an efficient symmetric-key encryption schemes from block ciphers.<h2 id=Electronic-Code-Book-ECB-Mode>Electronic Code Book (ECB) Mode</h2><p><img alt="ECB mode" src=ecb.png><p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo><mi mathvariant=normal>≔</mi></mo><msub><mi>E</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=false>)</mo><mi mathvariant=normal>∥</mi><mo>⋯</mo><mi mathvariant=normal>∥</mi><msub><mi>E</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>m</mi><mi>L</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Enc_k(m) \coloneqq E_k(m_1) \Vert \cdots \Vert E_k(m_L) </annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel><span class=mrel><span class=mop style=position:relative;top:-0.0347em;>:</span></span><span class=mrel><span class=mspace style=margin-right:-0.0667em;></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mord>∥</span><span class=mspace style=margin-right:0.1667em;></span><span class=minner>⋯</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord>∥</span><span class=mord><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span><p>ECB Mode just concatenate ciphertexts... although this has very serious problems!!!!<p>Problem 1) Since block cipher is deterministic, ECB mode is also deterministic.<br> Generally, secure modes use a uniform initialization vector (IV) to introduce randomness.<p><img alt="ECB penguin" src=ecb_penguin.png><p>Problem 2) ECB preserves patterns of the original message because same block of message will encrypted to same ciphertext.<br> e.g. If every block is just 0s or 1s, this will be encrypted to two different ciphertext... which is very predictable!<br> e.g. ECB penguin (in the above) still looks like penguin because same pixels are encrypted to same value.<h2 id=Cipher-Block-Chaining-CBC-Mode>Cipher Block Chaining (CBC) Mode</h2><p><img alt="CBC mode" src=cbc.png><ol><li>A uniform initialization vector (IV) is chosen as the initial ciphertext block. (<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>c</mi><mn>0</mn></msub><mo><mi mathvariant=normal>≔</mi></mo><mi>I</mi><mi>V</mi></mrow><annotation encoding=application/x-tex>c_0 \coloneqq IV</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel><span class=mrel><span class=mop style=position:relative;top:-0.0347em;>:</span></span><span class=mrel><span class=mspace style=margin-right:-0.0667em;></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>I</span><span class="mord mathnormal" style=margin-right:0.22222em;>V</span></span></span></span>)<li>Each ciphertext blocks are generated by applying the block cipher to the XOR of the current plaintext block and the previous ciphertext block. (<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo><mi mathvariant=normal>≔</mi></mo><msub><mi>E</mi><mi>k</mi></msub><mo stretchy=false>(</mo><msub><mi>c</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊕</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>c_i \coloneqq E_k(c_{i-1} \oplus m_i)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel><span class=mrel><span class=mop style=position:relative;top:-0.0347em;>:</span></span><span class=mrel><span class=mspace style=margin-right:-0.0667em;></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2083em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⊕</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>)</ol><p>Theorem (Security of CBC mode): If <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi><mo>:</mo><mi>K</mi><mo>×</mo><mi>X</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding=application/x-tex>E: K \times X \rightarrow X</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>:</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7667em;vertical-align:-0.0833em;></span><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>×</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>→</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span></span></span></span> is a secure PRP, then CBC mode is CPA-secure.<br> For any <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>q</span></span></span></span>-query adversary <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> against <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>E</mi><mrow><mi>C</mi><mi>B</mi><mi>C</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\mathcal{E}_{CBC}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathcal" style=margin-right:0.08944em;>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0894em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em;>CBC</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>, there exists a PRP adversary <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>B</mi></mrow><annotation encoding=application/x-tex>\mathcal{B}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.03041em;>B</span></span></span></span> against <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi></mrow><annotation encoding=application/x-tex>E</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span></span></span></span> such that<p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi><mi>d</mi><msub><mi>v</mi><msub><mi mathvariant=script>E</mi><mrow><mi mathvariant=script>C</mi><mi mathvariant=script>B</mi><mi mathvariant=script>C</mi></mrow></msub></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>≤</mo><mn>2</mn><mo>⋅</mo><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi>E</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>B</mi><mo stretchy=false>)</mo><mo>+</mo><mn>2</mn><mfrac><mrow><msup><mi>q</mi><mn>2</mn></msup><msup><mi>L</mi><mn>2</mn></msup></mrow><mrow><mi mathvariant=normal>∣</mi><mi>X</mi><mi mathvariant=normal>∣</mi></mrow></mfrac></mrow><annotation encoding=application/x-tex>Adv_{\mathcal{E_{CBC}}}(\mathcal{A}) \leq 2 \cdot Adv_{E}(\mathcal{B}) + 2\frac{q^2L^2}{|X|} </annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0003em;vertical-align:-0.2503em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3448em;><span style=top:-2.3567em;margin-left:-0.0894em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.05834em;>CBC</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.1433em;><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2503em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>2</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>E</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:2.4271em;vertical-align:-0.936em;></span><span class=mord>2</span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.4911em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span><span class=mord>∣</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">L</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.936em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>Proof sketch: Each query use <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>L</mi></mrow><annotation encoding=application/x-tex>L</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">L</span></span></span></span> block ciphers, resulting total of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi><mi>L</mi></mrow><annotation encoding=application/x-tex>qL</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8778em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class="mord mathnormal">L</span></span></span></span> block ciphers. By birthday paradox, we have <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>q</mi><mn>2</mn></msup><msup><mi>L</mi><mn>2</mn></msup></mrow><annotation encoding=application/x-tex>q^2L^2</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0085em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">L</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> term.<p>This is secure, and have better expansion rate (ciphertext is only l bit longer), but it is not used today.<ul><li>Encryption is sequential; Not parallelizable!<br> Note that decryption is parallelizable.<li>Decryption need inverse of block cipher.<li>We need different algorithms for encryption and decryption.<li>The message must be padded to a multiple of the block size. (This can be handled by ciphertext stealing with an extra complexity.) <ul><li>Since padded message should be longer than the original message, if the message is already a multiple of the block size, padding can be up to block size!<li>Extremely, when sending 1 byte message, message should be padded up to block size.</ul></ul><p>Warning: CBC mode is not secure if the adversary can predict IV for the next message!<br> e.g. A stateful variant of CBC-mode encryption (a.k.a. chained CBC mode) use the last block of the previous ciphertext as the IV of the next message. (This was actually used in SSL 3.0 and TLS 1.0!!!!!)<br> This is vulnerable to a chosen-plaintext attack! (And again, this was used in SSL 3.0 and TLS 1.0!)<br> Lesson: <strong>NEVER</strong> make modifications to cryptographic schemes, even if those modifications seem benign.<h2 id=Counter-CTR-Mode>Counter (CTR) Mode</h2><p><img alt="CTR Mode" src=ctr.png><ol><li>A uniform initialization vector (IV) is chosen as the initial ciphertext block. (<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>c</mi><mn>0</mn></msub><mo><mi mathvariant=normal>≔</mi></mo><mi>I</mi><mi>V</mi></mrow><annotation encoding=application/x-tex>c_0 \coloneqq IV</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel><span class=mrel><span class=mop style=position:relative;top:-0.0347em;>:</span></span><span class=mrel><span class=mspace style=margin-right:-0.0667em;></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>I</span><span class="mord mathnormal" style=margin-right:0.22222em;>V</span></span></span></span>)<li>Each ciphertext blocks are generated by applying the block cipher to <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>I</mi><mi>V</mi><mo>+</mo><mi>i</mi></mrow><annotation encoding=application/x-tex>IV + i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7667em;vertical-align:-0.0833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>I</span><span class="mord mathnormal" style=margin-right:0.22222em;>V</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.6595em;></span><span class="mord mathnormal">i</span></span></span></span>, then XORing with the current plaintext block. (<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo><mi mathvariant=normal>≔</mi></mo><msub><mi>F</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>I</mi><mi>V</mi><mo>+</mo><mi>i</mi><mo stretchy=false>)</mo><mo>⊕</mo><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>c_i \coloneqq F_k(IV + i) \oplus m_i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel><span class=mrel><span class=mop style=position:relative;top:-0.0347em;>:</span></span><span class=mrel><span class=mspace style=margin-right:-0.0667em;></span></span><span class=mrel>=</span></span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.13889em;>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.07847em;>I</span><span class="mord mathnormal" style=margin-right:0.22222em;>V</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal">i</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⊕</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.5806em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3117em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>)</ol><p>Technically, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>I</mi><mi>V</mi></mrow><annotation encoding=application/x-tex>IV</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>I</span><span class="mord mathnormal" style=margin-right:0.22222em;>V</span></span></span></span> is a random string, but we view as number and compute <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>I</mi><mi>V</mi><mo>+</mo><mi>i</mi></mrow><annotation encoding=application/x-tex>IV + i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7667em;vertical-align:-0.0833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>I</span><span class="mord mathnormal" style=margin-right:0.22222em;>V</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.6595em;></span><span class="mord mathnormal">i</span></span></span></span>.<p>Theorem (Security of CTR mode): If <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>F</mi><mo>:</mo><mi>K</mi><mo>×</mo><mi>X</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding=application/x-tex>F: K \times X \rightarrow X</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.13889em;>F</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>:</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7667em;vertical-align:-0.0833em;></span><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>×</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>→</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span></span></span></span> is a secure PRF, then CTR mode is CPA-secure.<br> For any <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi></mrow><annotation encoding=application/x-tex>q</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>q</span></span></span></span>-query adversary <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>A</mi></mrow><annotation encoding=application/x-tex>\mathcal{A}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal">A</span></span></span></span> against <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>E</mi><mrow><mi>C</mi><mi>T</mi><mi>R</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\mathcal{E}_{CTR}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathcal" style=margin-right:0.08944em;>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0894em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.00773em;>CTR</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>, there exists a PRF adversary <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>B</mi></mrow><annotation encoding=application/x-tex>\mathcal{B}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathcal" style=margin-right:0.03041em;>B</span></span></span></span> against <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>F</mi></mrow><annotation encoding=application/x-tex>F</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.13889em;>F</span></span></span></span> such that<p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi><mi>d</mi><msub><mi>v</mi><msub><mi mathvariant=script>E</mi><mrow><mi mathvariant=script>C</mi><mi mathvariant=script>T</mi><mi mathvariant=script>R</mi></mrow></msub></msub><mo stretchy=false>(</mo><mi mathvariant=script>A</mi><mo stretchy=false>)</mo><mo>≤</mo><mn>2</mn><mo>⋅</mo><mi>A</mi><mi>d</mi><msub><mi>v</mi><mi>F</mi></msub><mo stretchy=false>(</mo><mi mathvariant=script>B</mi><mo stretchy=false>)</mo><mo>+</mo><mn>2</mn><mfrac><mrow><msup><mi>q</mi><mn>2</mn></msup><mi>L</mi></mrow><mrow><mi mathvariant=normal>∣</mi><mi>X</mi><mi mathvariant=normal>∣</mi></mrow></mfrac></mrow><annotation encoding=application/x-tex>Adv_{\mathcal{E_{CTR}}}(\mathcal{A}) \leq 2 \cdot Adv_{F}(\mathcal{B}) + 2\frac{q^2L}{|X|} </annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0003em;vertical-align:-0.2503em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.08944em;>E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3448em;><span style=top:-2.3567em;margin-left:-0.0894em;margin-right:0.0714em;><span class=pstrut style=height:2.5em;></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style=margin-right:0.05834em;>C</span><span class="mord mathcal mtight" style=margin-right:0.25417em;>T</span><span class="mord mathcal mtight">R</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.1433em;><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2503em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal">A</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≤</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>2</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>⋅</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>v</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.13889em;>F</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathcal" style=margin-right:0.03041em;>B</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:2.4271em;vertical-align:-0.936em;></span><span class=mord>2</span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.4911em;><span style=top:-2.314em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord>∣</span><span class="mord mathnormal" style=margin-right:0.07847em;>X</span><span class=mord>∣</span></span></span><span style=top:-3.23em;><span class=pstrut style=height:3em;></span><span class=frac-line style=border-bottom-width:0.04em;></span></span><span style=top:-3.677em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">L</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.936em;><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>Proof sketch: Each query use <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>L</mi></mrow><annotation encoding=application/x-tex>L</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">L</span></span></span></span> block ciphers, resulting total of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi><mi>L</mi></mrow><annotation encoding=application/x-tex>qL</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8778em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class="mord mathnormal">L</span></span></span></span> block ciphers. However, because we are using consecutive strings (<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>I</mi><mi>V</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>IV+1</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7667em;vertical-align:-0.0833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>I</span><span class="mord mathnormal" style=margin-right:0.22222em;>V</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>1</span></span></span></span> ~ <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>I</mi><mi>V</mi><mo>+</mo><mi>L</mi></mrow><annotation encoding=application/x-tex>IV+L</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7667em;vertical-align:-0.0833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>I</span><span class="mord mathnormal" style=margin-right:0.22222em;>V</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">L</span></span></span></span>) instead of random <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>L</mi></mrow><annotation encoding=application/x-tex>L</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal">L</span></span></span></span> strings, collision probability is <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>q</mi><mn>2</mn></msup><mi>L</mi></mrow><annotation encoding=application/x-tex>q^2L</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0085em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">L</span></span></span></span> instead of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>q</mi><mn>2</mn></msup><msup><mi>L</mi><mn>2</mn></msup></mrow><annotation encoding=application/x-tex>q^2L^2</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0085em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">L</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>.<p>This is a complete upgrade over CBC mode!<ol><li>We only need PRF instead of PRP!<li>Encryption/decryption is parallelizable!<br> In fact CTR can precompute encryption! We generate IV and precompute block ciphers before receiving message.<li>Factor is <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>q</mi><mn>2</mn></msup><mi>L</mi></mrow><annotation encoding=application/x-tex>q^2L</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0085em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">L</span></span></span></span> instead of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>q</mi><mn>2</mn></msup><msup><mi>L</mi><mn>2</mn></msup></mrow><annotation encoding=application/x-tex>q^2L^2</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.0085em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">L</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8141em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>!<br> This means that CTR takes less time to change keys than CBC. This was meaningless when CBC came out, (old systems didn't track <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi><mo separator=true>,</mo><mi>L</mi></mrow><annotation encoding=application/x-tex>q, L</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8778em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">L</span></span></span></span> at all) but it's important nowadays because of too many queries.<li>CTR can reuse same algorithm for encryption/decryption!<li>CTR doesn't need padding!</ol><h2 id=Nonce-based-Encryption>Nonce-based Encryption</h2><p>IV should be random and generated for each message. This is very tedious...<br> Instead, we can make nonce-based encryption, where the encryption and decryption algorithms additionally accept a nonce as input. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>E</mi><mi>n</mi><msub><mi>c</mi><mi>k</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo separator=true>,</mo><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Enc_k(m,n)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>E</span><span class="mord mathnormal">n</span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3361em;><span style=top:-2.55em;margin-left:0em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03148em;>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span></span><ul><li>Nonce should be used once, and never repeated.<li>Nonce doesn't have to be a true random string, it can be a counter value, or the current time!<br> This is useful for lightweight systems where generating high-quality randomness is expensive or impossible.<br> You can even reveal the nonce, and it's still secure!<li>Since nonce provides sort of non-deterministic way, encryption/decryption algorithm can be deterministic (and it's still secure)!<br> CPA security definition can be defined in a similar manner, but the adversary cannot choose the same nonce more than once during the security game.</ul><p>Nonce-based encryption is very good!<br> However, it's not suitable for communicating with millions of clients. (You have to ensure that each client's nonce is unique!)<br> Generating IV from your side is much easier and faster way to achieve security.</div><footer class=post-footer><div class=post-nav><div class=post-nav-item><a title="Block Ciphers" href=/posts/105/ rel=prev> <i class="fa fa-angle-left"></i> Block Ciphers </a></div><div class=post-nav-item></div></div></footer></article></div><div class="comments utterances-container"></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© 2023 – <span itemprop=copyrightYear>2025</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>CookieHCl</span></div><div class=powered-by>Powered by <a href=https://hexo.io/ rel=noopener target=_blank>Hexo</a> & <a href=https://theme-next.js.org/muse/ rel=noopener target=_blank>NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label="Back to top" class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><div class=reading-progress-bar></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script class=next-config data-name=utterances type=application/json>{"enable":true,"repo":"CookieHCl/cookiehcl.github.io","issue_term":"pathname","theme":"github-light"}</script><script defer src=/js/third-party/comments/utterances.js></script>