<!doctype html><html lang=en><meta charset=UTF-8><meta content="width=device-width" name=viewport><meta content=#222 name=theme-color><meta content="Hexo 8.0.0" name=generator><link crossorigin href=https://cdnjs.cloudflare.com rel=preconnect><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css rel=stylesheet><link integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"cookiehcl.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.25.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"agate","dark":"agate"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":true,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script defer src=/js/config.js></script><meta content="Network security  Confidentiality: only sender, intended receiver should understand message contents  Sender encrypts message Receiver decrypts message   Authentication: sender, receiver want to confi" name=description><meta content=article property=og:type><meta content="Network Security" property=og:title><meta content=https://cookiehcl.github.io/posts/85/index.html property=og:url><meta content="기억 저장소" property=og:site_name><meta content="Network security  Confidentiality: only sender, intended receiver should understand message contents  Sender encrypts message Receiver decrypts message   Authentication: sender, receiver want to confi" property=og:description><meta content=en_US property=og:locale><meta content=https://cookiehcl.github.io/posts/85/mitm_attack.png property=og:image><meta content=2025-05-28T07:16:18.000Z property=article:published_time><meta content=2025-05-28T07:16:18.000Z property=article:modified_time><meta content=CookieHCl property=article:author><meta content=summary name=twitter:card><meta content=https://cookiehcl.github.io/posts/85/mitm_attack.png name=twitter:image><link href=https://cookiehcl.github.io/posts/85/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://cookiehcl.github.io/posts/85/","path":"posts/85/","title":"Network Security"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Network Security | 기억 저장소</title><script integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script defer src=/js/utils.js></script><script defer src=/js/motion.js></script><script defer src=/js/sidebar.js></script><script defer src=/js/next-boot.js></script><script integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js></script><script defer src=/js/third-party/search/local-search.js></script><script class=next-config data-name=mermaid type=application/json>{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.10.1/mermaid.min.js","integrity":"sha256-BmQmdWDS8X2OTbrwELWK366LV6escyWhHHe0XCTU/Hk="}}</script><script defer src=/js/third-party/tags/mermaid.js></script><script class=next-config data-name=enableMath type=application/json>true</script><link integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css rel=stylesheet><script class=next-config data-name=katex type=application/json>{"copy_tex_js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js","integrity":"sha256-Us54+rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs="}}</script><script defer src=/js/third-party/math/katex.js></script><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label="Toggle navigation bar" class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>기억 저장소</p> <i class=logo-line></i> </a></div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=Search role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>About</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>Tags</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>Categories</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>Archives</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>Search </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=Searching... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>Table of Contents<li class=sidebar-nav-overview>Overview</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>1.</span> <span class=nav-text>Network security</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#Attacks-on-internet-security><span class=nav-number>1.1.</span> <span class=nav-text>Attacks on internet security</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>2.</span> <span class=nav-text>Cryptography</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#Breaking-an-encryption-scheme><span class=nav-number>2.1.</span> <span class=nav-text>Breaking an encryption scheme</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Symmetric-key-cryptography><span class=nav-number>2.2.</span> <span class=nav-text>Symmetric key cryptography</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Substitution-cipher><span class=nav-number>2.2.1.</span> <span class=nav-text>Substitution cipher</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Attack-on-Substitution-cipher><span class=nav-number>2.2.2.</span> <span class=nav-text>Attack on Substitution cipher</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#DES-AES><span class=nav-number>2.3.</span> <span class=nav-text>DES, AES</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Public-key-cryptography><span class=nav-number>2.4.</span> <span class=nav-text>Public key cryptography</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Requirements-of-public-key-cryptography><span class=nav-number>2.4.1.</span> <span class=nav-text>Requirements of public key cryptography</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#RSA-Rivest-Shamir-Adelson-algorithm><span class=nav-number>2.4.2.</span> <span class=nav-text>RSA (Rivest, Shamir, Adelson) algorithm</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#Creating-public-private-key-pair><span class=nav-number>2.4.2.1.</span> <span class=nav-text>Creating public/private key pair</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#Encryption-and-decryption-of-RSA><span class=nav-number>2.4.2.2.</span> <span class=nav-text>Encryption and decryption of RSA</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#Attacking-RSA><span class=nav-number>2.4.2.3.</span> <span class=nav-text>Attacking RSA?</span></a></ol></ol></ol><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>3.</span> <span class=nav-text>Authentication</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#ap1-0><span class=nav-number>3.1.</span> <span class=nav-text>ap1.0</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#ap2-0><span class=nav-number>3.2.</span> <span class=nav-text>ap2.0</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#ap3-0><span class=nav-number>3.3.</span> <span class=nav-text>ap3.0</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#ap4-0><span class=nav-number>3.4.</span> <span class=nav-text>ap4.0</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#ap5-0><span class=nav-number>3.5.</span> <span class=nav-text>ap5.0</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Man-in-the-middle-MITM-attack><span class=nav-number>3.5.1.</span> <span class=nav-text>Man in the middle (MITM) attack</span></a></ol></ol><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>4.</span> <span class=nav-text>Message Integrity</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#Digital-Signatures><span class=nav-number>4.1.</span> <span class=nav-text>Digital Signatures</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Message-digests><span class=nav-number>4.2.</span> <span class=nav-text>Message digests</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Hash-function-algorithms><span class=nav-number>4.2.1.</span> <span class=nav-text>Hash function algorithms</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Public-key-certification-authorities-CA><span class=nav-number>4.3.</span> <span class=nav-text>Public key certification authorities (CA)</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>5.</span> <span class=nav-text>Secure message</span></a></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><p class=site-author-name itemprop=name>CookieHCl<div class=site-description itemprop=description></div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>104</span> <span class=site-state-item-name>posts</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>24</span> <span class=site-state-item-name>categories</span></a></div></nav></div><div class="links-of-author animated"><span class=links-of-author-item> <a rel="noopener me" title="GitHub → https://github.com/CookieHCl" href=https://github.com/CookieHCl target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a rel="noopener me" title="BOJ → https://www.acmicpc.net/user/CookieHCl" href=https://www.acmicpc.net/user/CookieHCl target=_blank><i class="fa fa-code fa-fw"></i>BOJ</a> </span><span class=links-of-author-item> <a rel="noopener me" title="solved.ac → https://solved.ac/profile/CookieHCl" href=https://solved.ac/profile/CookieHCl target=_blank><i class="fa fa-audio-description fa-fw"></i>solved.ac</a> </span></div><div class="cc-license animated" itemprop=license><a class=cc-opacity href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ko rel=noopener target=_blank><img alt="Creative Commons" src=https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg></a></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=en><link href=https://cookiehcl.github.io/posts/85/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/images/avatar.gif itemprop=image> <meta content=CookieHCl itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="기억 저장소" itemprop=name> <meta itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="Network Security | 기억 저장소" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>Network Security</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>Posted on</span> <time itemprop="dateCreated datePublished" title="Created: 2025-05-28 16:16:18" datetime=2025-05-28T16:16:18+09:00>2025-05-28</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>In</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/ itemprop=url rel=index><span itemprop=name>SNU</span></a> </span> , <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/4-1/ itemprop=url rel=index><span itemprop=name>4-1</span></a> </span> , <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/4-1/%EC%BB%B4%ED%93%A8%ED%84%B0%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC/ itemprop=url rel=index><span itemprop=name>컴퓨터네트워크</span></a> </span> </span><span title="Reading time" class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>Reading time ≈</span> <span>6 mins.</span> </span></div></div></header><div class=post-body itemprop=articleBody><h1>Network security</h1><ul><li>Confidentiality: only sender, intended receiver should understand message contents <ul><li>Sender encrypts message<li>Receiver decrypts message</ul><li>Authentication: sender, receiver want to confirm identity of each other<li>Message integrity: sender, receiver want to ensure message not altered (in transit, or afterwards) without detection<li>Access and availability: services must be accessible and available to users</ul><h2 id=Attacks-on-internet-security>Attacks on internet security</h2><p>Bob and Alice want to communicate securely each other.<br> Trudy (intruder) may interrupt!<ul><li>Eavesdrop: intercept messages<li>Actively insert messages into connection<li>Impersonation: can fake (spoof) source address in packet (or any field in packet)<li>Hijacking: take over ongoing connection by removing sender or receiver, then inserting himself in place<li>Denial of Service: prevent service from being used by others (e.g. by overloading resources)</ul><h1>Cryptography</h1><p>Alice wants to send a plaintext message <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">m</span></span></span></span>.<br> She sends a ciphertext <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>K</mi><mi>A</mi></msub><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_A(m)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>)</span></span></span></span> encrypted with her encryption key <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>K</mi><mi>A</mi></msub></mrow><annotation encoding=application/x-tex>K_A</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>. Bob decrypt it with Bob's decryption key <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>K</mi><mi>B</mi></msub></mrow><annotation encoding=application/x-tex>K_B</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>, and get the original message <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">m</span></span></span></span>.<h2 id=Breaking-an-encryption-scheme>Breaking an encryption scheme</h2><ul><li>Cipher-text only attack: Trudy has ciphertext she can analyze. <ul><li>Brute force: Search through all keys<li>Statistical analysis</ul><li>Known-plaintext attack: Trudy has plaintext and corresponding ciphertext. (e.g. ciphertext for a, b, c, ...)<li>Chosen-plaintext attack: Trudy can get ciphertext for chosen plaintext.</ul><h2 id=Symmetric-key-cryptography>Symmetric key cryptography</h2><p>Bob and Alice share same (symmetric) key <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>K</mi><mi>S</mi></msub></mrow><annotation encoding=application/x-tex>K_S</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>S</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>.<br> Bob and Alice should agree on key value.<h3 id=Substitution-cipher>Substitution cipher</h3><p>Substitute one letter for another.<br> Encryption key is mapping from set of 26 letters (alphabets) to set of 26 letters.<p>We can also use n subtitution ciphers (e.g. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>M</mi><mn>2</mn></msub><mo separator=true>,</mo><msub><mi>M</mi><mn>3</mn></msub><mo separator=true>,</mo><msub><mi>M</mi><mn>4</mn></msub><mo separator=true>,</mo><msub><mi>M</mi><mn>5</mn></msub></mrow><annotation encoding=application/x-tex>M_1, M_2, M_3, M_4, M_5</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8778em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>) and cycling pattern. (e.g. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>M</mi><mn>3</mn></msub><mo separator=true>,</mo><msub><mi>M</mi><mn>4</mn></msub><mo separator=true>,</mo><msub><mi>M</mi><mn>5</mn></msub><mo separator=true>,</mo><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>M_1, M_3, M_4, M_5, M_2</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8778em;vertical-align:-0.1944em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>).<p>For each new letter, use subsequent substitution pattern in cyclic pattern.<br> e.g. When encrypting <em>dog</em>, encrypt <em>d</em> with <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>M_1</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>, encyrpt <em>o</em> with <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>M</mi><mn>3</mn></msub></mrow><annotation encoding=application/x-tex>M_3</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>, then encrypt <em>g</em> with <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>M</mi><mn>4</mn></msub></mrow><annotation encoding=application/x-tex>M_4</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3011em;><span style=top:-2.55em;margin-left:-0.109em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>.<br> Encryption key is n substitution ciphers and cyclic pattern.<h3 id=Attack-on-Substitution-cipher>Attack on Substitution cipher</h3><p>If input is same, output is always same! Statistical analysis can be used to get the mapping.<h2 id=DES-AES>DES, AES</h2><p>DES (Data Encyrption Standard) is US encryption standard, (NIST 1993) but it can be decrypted in less than a day with bruteforce.<br> However, there are no known good analytic attack.<br> 3DES was used briefly, which encrypt 3 times using DES, with 3 different keys.<p>Later AES replaced DES in November 2001.<br> Brute force decryption takes 149 trillion years for AES.<br> This is widely used, and even CPU and datacenter network cards have hardware implementation for AES.<h2 id=Public-key-cryptography>Public key cryptography</h2><p>Alice and Bob have public key and private key.<br> Public encryption key is known to everyone, but private decryption key is known only to them.<ol><li>Alice encrypt plaintext message <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>m</mi></mrow><annotation encoding=application/x-tex>m</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">m</span></span></span></span> with Bob's public key <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>B</mi><mo>+</mo></msubsup></mrow><annotation encoding=application/x-tex>K_B^+</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span></span></span></span>.<li>Bob decrypt ciphertext <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>B</mi><mo>+</mo></msubsup><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_B^+(m)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>)</span></span></span></span> with Bob's private key <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>B</mi><mo>−</mo></msubsup></mrow><annotation encoding=application/x-tex>K_B^-</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span></span></span></span>.</ol><p>Ciphertext can't decrypted with public key!<br> We can just open public key to anyone.<h3 id=Requirements-of-public-key-cryptography>Requirements of public key cryptography</h3><ul><li>Private key can decrypt message encrypted with public key.<li>Private key can't be computed from public key.</ul><p>Obviously, public key and private keys are paired!<br> We cannot change only one of the keys.<h3 id=RSA-Rivest-Shamir-Adelson-algorithm>RSA (Rivest, Shamir, Adelson) algorithm</h3><p>Every message can be represented as bit pattern, and bit pattern can be uniquely represented by an integer number.<br> Therefore, we can encrypt any message if we can encrypt any number.<p>RSA is actually slower than AES, so normally we use RSA to only establish secure connection.<br> First, Bob and Alice use RSA to exchange a symmetric session key.<br> Then, they use symmetric key cryptography to actually send the data.<h4 id=Creating-public-private-key-pair>Creating public/private key pair</h4><ol><li>Choose two large prime numbers p, q. (Normally 1024 bits)<li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mi>q</mi><mo separator=true>,</mo><mi>z</mi><mo>=</mo><mo stretchy=false>(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo><mo stretchy=false>(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>n = pq, z = (p - 1)(q - 1)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>pq</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class="mord mathnormal">p</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>)</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>)</span></span></span></span>.<li>Choose <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>e</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>e &lt; n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.5782em;vertical-align:-0.0391em;></span><span class="mord mathnormal">e</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span></span></span></span> that has no common factors with <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>z</mi></mrow><annotation encoding=application/x-tex>z</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span></span></span></span>. (i.e. e and z are relatively prime)<li>Choose <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>d</mi></mrow><annotation encoding=application/x-tex>d</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal">d</span></span></span></span> such that <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>e</mi><mi>d</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>ed-1</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.7778em;vertical-align:-0.0833em;></span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>1</span></span></span></span> is divisible by <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>z</mi></mrow><annotation encoding=application/x-tex>z</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span></span></span></span>. (i.e. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>e</mi><mi>d</mi><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>z</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>ed \bmod z = 1</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>1</span></span></span></span>)<li>Public key is <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>B</mi><mo>+</mo></msubsup><mo>=</mo><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mi>e</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_B^+ = (n, e)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">e</span><span class=mclose>)</span></span></span></span>, and private key is <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>B</mi><mo>−</mo></msubsup><mo>=</mo><mo stretchy=false>(</mo><mi>n</mi><mo separator=true>,</mo><mi>d</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_B^- = (n, d)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class="mord mathnormal">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">d</span><span class=mclose>)</span></span></span></span>.</ol><h4 id=Encryption-and-decryption-of-RSA>Encryption and decryption of RSA</h4><ul><li>To encrypt message <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>m</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>m &lt; n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.5782em;vertical-align:-0.0391em;></span><span class="mord mathnormal">m</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span></span></span></span>, compute <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>e</mi></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>c = m^e \bmod n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">c</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6944em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6644em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span></span></span></span>.<li>To decrypt ciphertext <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>c</mi></mrow><annotation encoding=application/x-tex>c</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">c</span></span></span></span>, compute <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>m</mi><mo>=</mo><msup><mi>c</mi><mi>d</mi></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>m = c^d \bmod n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">m</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.8491em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8491em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span></span></span></span>.</ul><p>Euler's Theorem states that if <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>gcd</mi><mo>⁡</mo><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\gcd(x, n) = 1</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mop><span style=margin-right:0.01389em;>g</span>cd</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">n</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>1</span></span></span></span>, then <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mi>x</mi><mi>z</mi></msup><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width=0.4444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333em><mi>n</mi><mo stretchy=false>)</mo><annotation encoding=application/x-tex>x^z \equiv 1 \pmod n</annotation><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6644em;></span><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6644em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.04398em;>z</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>≡</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>1</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:0.4444em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.3333em;></span><span class="mord mathnormal">n</span><span class=mclose>)</span></span></span>.<br> Recall) <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mi>q</mi><mo separator=true>,</mo><mi>z</mi><mo>=</mo><mo stretchy=false>(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo><mo stretchy=false>(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>n = pq, z = (p-1)(q-1)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.625em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>pq</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.04398em;>z</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class="mord mathnormal">p</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>)</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.03588em;>q</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>−</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord>1</span><span class=mclose>)</span></span></span></span>. <p>Therefore, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>∀</mi><mi>x</mi><mo separator=true>,</mo><mi>y</mi><mo separator=true>,</mo><msup><mi>x</mi><mi>y</mi></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi><mo>=</mo><msup><mi>x</mi><mrow><mi>y</mi><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>z</mi></mrow></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>\forall x,y, x^y \bmod n = x^{y \bmod z} \bmod n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8889em;vertical-align:-0.1944em;></span><span class=mord>∀</span><span class="mord mathnormal">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.03588em;>y</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.6644em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.03588em;>y</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.8491em;></span><span class=mord><span class="mord mathnormal">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8491em;><span style=top:-3.063em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.03588em;>y</span><span class="mspace mtight" style=margin-right:0.3253em;></span><span class="mbin mtight"><span class="mord mtight"><span class="mord mathrm mtight">mod</span></span></span><span class="mspace mtight" style=margin-right:0.3253em;></span><span class="mord mathnormal mtight" style=margin-right:0.04398em;>z</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span></span></span></span> if <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>gcd</mi><mo>⁡</mo><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>n</mi><mo stretchy=false>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\gcd(x, n) = 1</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mop><span style=margin-right:0.01389em;>g</span>cd</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">n</span><span class=mclose>)</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6444em;></span><span class=mord>1</span></span></span></span>.</p> <p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mtable columnalign="right left" columnspacing=0em rowspacing=0.25em><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mo>∴</mo><msup><mi>c</mi><mi>d</mi></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><msup><mrow><mo fence=true>(</mo><msup><mi>m</mi><mi>e</mi></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi><mo fence=true>)</mo></mrow><mi>d</mi></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><msup><mi>m</mi><mrow><mi>e</mi><mi>d</mi></mrow></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><msup><mi>m</mi><mrow><mi>e</mi><mi>d</mi><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>z</mi></mrow></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><msup><mi>m</mi><mn>1</mn></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>=</mo><mi>m</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{align*} \therefore c^d \bmod n &= \left( m^e \bmod n \right)^d \bmod n \\ &= m^{ed} \bmod n \\ &= m^{ed \bmod z} \bmod n \\ &= m^1 \bmod n \\ &= m \end{align*}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:7.7913em;vertical-align:-3.6457em;></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.1457em;><span style=top:-6.1567em;><span class=pstrut style=height:3em;></span><span class=mord><span class="mrel amsrm">∴</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mord mathnormal">c</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8991em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal">n</span></span></span><span style=top:-4.5976em;><span class=pstrut style=height:3em;></span><span class=mord></span></span><span style=top:-3.0384em;><span class=pstrut style=height:3em;></span><span class=mord></span></span><span style=top:-1.5143em;><span class=pstrut style=height:3em;></span><span class=mord></span></span><span style=top:-0.0143em;><span class=pstrut style=height:3em;></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.6457em;><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.1457em;><span style=top:-6.1567em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0em;>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7144em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal">n</span><span class="mclose delimcenter" style=top:0em;>)</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.989em;><span style=top:-3.2029em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal">n</span></span></span><span style=top:-4.5976em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8991em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal">n</span></span></span><span style=top:-3.0384em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8991em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span><span class="mspace mtight" style=margin-right:0.3253em;></span><span class="mbin mtight"><span class="mord mtight"><span class="mord mathrm mtight">mod</span></span></span><span class="mspace mtight" style=margin-right:0.3253em;></span><span class="mord mathnormal mtight" style=margin-right:0.04398em;>z</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal">n</span></span></span><span style=top:-1.5143em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8641em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal">n</span></span></span><span style=top:-0.0143em;><span class=pstrut style=height:3em;></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span><span class="mord mathnormal">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.6457em;><span></span></span></span></span></span></span></span></span></span></span></span></p> <p>In fact, public key and private key can be applied in any order!</p> <p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mrow><mo fence=true>(</mo><msup><mi>m</mi><mi>e</mi></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi><mo fence=true>)</mo></mrow><mi>d</mi></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi><mo>=</mo><msup><mi>m</mi><mrow><mi>e</mi><mi>d</mi></mrow></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi><mo>=</mo><msup><mrow><mo fence=true>(</mo><msup><mi>m</mi><mi>d</mi></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi><mo fence=true>)</mo></mrow><mi>e</mi></msup><mtext> </mtext><mo lspace=0.22em rspace=0.22em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow></mo><mtext> </mtext><mi>n</mi></mrow><annotation encoding=application/x-tex>\left( m^e \bmod n \right)^d \bmod n = m^{ed} \bmod n = \left( m^d \bmod n \right)^e \bmod n </annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.239em;vertical-align:-0.25em;></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0em;>(</span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.7144em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal">n</span><span class="mclose delimcenter" style=top:0em;>)</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.989em;><span style=top:-3.2029em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.8991em;></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8991em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.3034em;vertical-align:-0.35em;></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0em;><span class="delimsizing size1">(</span></span><span class=mord><span class="mord mathnormal">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.8991em;><span style=top:-3.113em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class="mord mathnormal">n</span><span class="mclose delimcenter" style=top:0em;><span class="delimsizing size1">)</span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:0.9534em;><span style=top:-3.352em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin><span class=mord><span class="mord mathrm">mod</span></span></span><span class=mspace style=margin-right:0.0556em;></span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span></span></span></span></span></p> <h4 id=Attacking-RSA>Attacking RSA?</h4> <p>To get a private key from public key, essentially you need to find factors of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">n</span></span></span></span>.<br> Howevery, factoring a big number is very hard!</p> <p>If quantum computers are commercialized, prime factorization will become easier and RSA will be vulnerable.<br> There are post-quantum cryptography which is safe even when quantum computers are used.</p> <h1>Authentication</h1> <p>Goal: Bob wants Alice to prove her identity to him</p> <h2 id=ap1-0>ap1.0</h2> <p>Alice says <em>"I am Alice"</em>, but Trudy can do the same..</p> <h2 id=ap2-0>ap2.0</h2> <p>Alice says <em>"I am Alice"</em> with Alice's IP address, but Trudy can do the same... (Packet spoofing)</p> <h2 id=ap3-0>ap3.0</h2> <p>Alice says <em>"I am Alice"</em> with Alice's password, but Trudy can record and repeat Alice's packet. (Playback attack)</p> <p>(Alice can encrypt her password with Bob's public key, but playback attack still works)</p> <h2 id=ap4-0>ap4.0</h2> <p>Alice says <em>"I am Alice"</em>, then Bob send nonce to Alice.<br> Nonce is a random number used only once-in-a-lifetime.<br> Alice must return nonce, encrypted with shared secret key.</p> <p>This works, but how do we get shared secret key in the first place?</p> <h2 id=ap5-0>ap5.0</h2> <p>Alice says <em>"I am Alice"</em>, then Bob send nonce to Alice.<br> Alice return nonce encrypted with Alice's private key.<br> Bob gets Alice's public key, then verify nonce.<br> Afterwards, Bob send message to Alice using Alice's public key!</p> <p>Also called challenge-response protocol!</p> <p>Recall) RSA can swap private/public keys! Encrypted message with private key can decrypted with public key.</p> <h3 id=Man-in-the-middle-MITM-attack>Man in the middle (MITM) attack</h3> <p><img alt="Man in the middle attack" src=mitm_attack.png></p> <p>Problem: We don't verify whether public key actually belongs to Alice!</p> <p>Trudy poses as Alice to Bob, and as Bob to Alice.<br> Bob gets Trudy's public key instead of Alice's public key!<br> Trudy can read every message (or even modify it).</p> <h1>Message Integrity</h1> <h2 id=Digital-Signatures>Digital Signatures</h2> <p>Goal: Verifable and nonforgeable. Recipient (Alice) can prove to someone that sender (Bob), and no one else, must have signed document.</p> <ol><li>Bob sends message m with signature <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>B</mi><mo>−</mo></msubsup><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_B^-(m)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>)</span></span></span></span>. (message encrypted with Bob's private key)<li>Alice verifies signature with Bob's public key.<li>If <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>B</mi><mo>+</mo></msubsup><mo stretchy=false>(</mo><msubsup><mi>K</mi><mi>B</mi><mo>−</mo></msubsup><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo>=</mo><mi>m</mi></mrow><annotation encoding=application/x-tex>K_B^+(K_B^-(m)) = m</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>))</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.4306em;></span><span class="mord mathnormal">m</span></span></span></span>, Alice can verify that: <ol><li>Bob signed m<li>No one else signed m<li>Bob signed m and not m'</ol></ol> <h2 id=Message-digests>Message digests</h2> <p>It is computationally expensive to encrypt/decrypt long messages.<br> Goal: We need fixed-length, easy-to-compute digital fingerprint!</p> <p>Instead of the entire message, we apply hash function to message, then encrypte it.<br> Hashed message is called message digest.</p> <ol><li>Bob sends message m with signature <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>B</mi><mo>−</mo></msubsup><mo stretchy=false>(</mo><mi>H</mi><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_B^-(H(m))</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>))</span></span></span></span>.<li>Alice receives m, and apply hash function to get <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(m)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>)</span></span></span></span>.<li>Alice verifies signature with Bob's public key, then check if <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>B</mi><mo>+</mo></msubsup><mo stretchy=false>(</mo><msubsup><mi>K</mi><mi>B</mi><mo>−</mo></msubsup><mo stretchy=false>(</mo><mi>H</mi><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo>=</mo><mi>H</mi><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_B^+(K_B^-(H(m))) = H(m)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>)))</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>)</span></span></span></span>.</ol> <h3 id=Hash-function-algorithms>Hash function algorithms</h3> <p>MD5 was widely used, but deprecated due to vulnerability. (Collisions can made in less than 1 second)<br> SHA-1 is used, but it was not secure enough, and it should be phased out by 2030.</p> <p>Currently SHA-256 is used.<br> We can get more secure hash function by increasing hash length. (e.g. SHA-512, SHA-3)<br> But secure hash functions are slower, so SHA-256 is favored.</p> <h2 id=Public-key-certification-authorities-CA>Public key certification authorities (CA)</h2> <p>Problem: Signature doesn't help MITM atack, we still doesn't know whether the public key belongs to Alice!<br> We need a way to verify which public key belongs to an entity.</p> <p>CA binds public key to particular entity.<br> When entity E registers its public key with CA, CA creates certificate binding identity E to its public key.<br> Essentially it is a E's public key encrypted with CA's private key. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mrow><mi>C</mi><mi>A</mi></mrow><mo>−</mo></msubsup><mo stretchy=false>(</mo><msubsup><mi>K</mi><mi>E</mi><mo>+</mo></msubsup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_{CA}^-(K_E^+)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em;>C</span><span class="mord mathnormal mtight">A</span></span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>E</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>.<br> Receiver can verify certificate with CA's public key to get E's public key. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mrow><mi>C</mi><mi>A</mi></mrow><mo>+</mo></msubsup><mo stretchy=false>(</mo><msubsup><mi>K</mi><mrow><mi>C</mi><mi>A</mi></mrow><mo>−</mo></msubsup><mo stretchy=false>(</mo><msubsup><mi>K</mi><mi>E</mi><mo>+</mo></msubsup><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo>=</mo><msubsup><mi>K</mi><mi>E</mi><mo>+</mo></msubsup></mrow><annotation encoding=application/x-tex>K_{CA}^+(K_{CA}^-(K_E^+)) = K_E^+</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em;>C</span><span class="mord mathnormal mtight">A</span></span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:0.07153em;>C</span><span class="mord mathnormal mtight">A</span></span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>E</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mclose>))</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>E</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span></span></span></span>.</p> <p>Problem: How do we even believe CA?? + How do we get CA's public key in the first place?<br> Solution: Browsers hardcode known CA's public keys...</p> <h1>Secure message</h1> <p>How can Alice send message m to Bob, with confidentiality, message integrity, and authentication?</p> <ol><li>Alice generates message digest with Alice's private key. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>A</mi><mo>−</mo></msubsup><mo stretchy=false>(</mo><mi>H</mi><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_A^-(H(m))</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>))</span></span></span></span>.<li>Combine message and message digest to one message. (Message integrity, Authentication) <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>M</mi><mo>=</mo><mi>m</mi><mo>+</mo><msubsup><mi>K</mi><mi>A</mi><mo>−</mo></msubsup><mo stretchy=false>(</mo><mi>H</mi><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>M = m + K_A^-(H(m))</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6667em;vertical-align:-0.0833em;></span><span class="mord mathnormal">m</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>))</span></span></span></span><li>Alice generates random symmetric private key <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>K</mi><mi>S</mi></msub></mrow><annotation encoding=application/x-tex>K_S</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>S</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>.<li>Alice encrypts message with symmetric key. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>K</mi><mi>S</mi></msub><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_S(M)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>S</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=mclose>)</span></span></span></span><li>Bob needs to know the symmetric key too, Alice encrypts symmetric key with Bob's public key. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>B</mi><mo>+</mo></msubsup><mo stretchy=false>(</mo><msub><mi>K</mi><mi>S</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_B^+(K_S)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>S</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span><li>Alice sends Bob <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>K</mi><mi>S</mi></msub><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_S(M)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>S</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=mclose>)</span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>B</mi><mo>+</mo></msubsup><mo stretchy=false>(</mo><msub><mi>K</mi><mi>S</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_B^+(K_S)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>S</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>. (Confidentiality)</ol> <p>Alice need three keys: Alice's private key, Bob's public key, new symmetric key.</p> <ol><li>Bob decrypt <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>B</mi><mo>+</mo></msubsup><mo stretchy=false>(</mo><msub><mi>K</mi><mi>S</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_B^+(K_S)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05017em;>B</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>S</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> with his private key and recover <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>K</mi><mi>S</mi></msub></mrow><annotation encoding=application/x-tex>K_S</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>S</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span>.<li>Bob decrypt <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>K</mi><mi>S</mi></msub><mo stretchy=false>(</mo><mi>M</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_S(M)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>S</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=mclose>)</span></span></span></span> with <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>K</mi><mi>S</mi></msub></mrow><annotation encoding=application/x-tex>K_S</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8333em;vertical-align:-0.15em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.3283em;><span style=top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:0.05764em;>S</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.15em;><span></span></span></span></span></span></span></span></span></span> and recover <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>M</mi><mo>=</mo><mi>m</mi><mo>+</mo><msubsup><mi>K</mi><mi>A</mi><mo>−</mo></msubsup><mo stretchy=false>(</mo><mi>H</mi><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>M = m + K_A^-(H(m))</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6667em;vertical-align:-0.0833em;></span><span class="mord mathnormal">m</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>+</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>))</span></span></span></span>.<li>Bob apply hash function to message. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>H(m)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>)</span></span></span></span><li>Bob decrypt message digest using Alice's public key. <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mi>K</mi><mi>A</mi><mo>+</mo></msubsup><mo stretchy=false>(</mo><msubsup><mi>K</mi><mi>A</mi><mo>−</mo></msubsup><mo stretchy=false>(</mo><mi>H</mi><mo stretchy=false>(</mo><mi>m</mi><mo stretchy=false>)</mo><mo stretchy=false>)</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>K_A^+(K_A^-(H(m)))</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.105em;vertical-align:-0.2935em;></span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:0.07153em;>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:0.8115em;><span style=top:-2.4065em;margin-left:-0.0715em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span><span style=top:-3.1031em;margin-right:0.05em;><span class=pstrut style=height:2.7em;></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:0.2935em;><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.08125em;>H</span><span class=mopen>(</span><span class="mord mathnormal">m</span><span class=mclose>)))</span></span></span></span><li>Bob verify whether two are same.</ol> <footer class=post-footer><div class=post-nav><div class=post-nav-item><a title="Evaluation with users" href=/posts/84/ rel=prev> <i class="fa fa-angle-left"></i> Evaluation with users </a></div><div class=post-nav-item><a title="Radiosity and Photon Mapping" href=/posts/86/ rel=next> Radiosity and Photon Mapping <i class="fa fa-angle-right"></i> </a></div></div></footer> <div class="comments utterances-container"></div> <footer class=footer><div class=footer-inner><div class=copyright>© 2023 – <span itemprop=copyrightYear>2025</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>CookieHCl</span></div><div class=powered-by>Powered by <a href=https://hexo.io/ rel=noopener target=_blank>Hexo</a> & <a href=https://theme-next.js.org/muse/ rel=noopener target=_blank>NexT.Muse</a></div></div></footer> <div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div> <div class=sidebar-dimmer></div> <div aria-label="Back to top" class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div> <div class=reading-progress-bar></div> <noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript> <script class=next-config data-name=utterances type=application/json>{"enable":true,"repo":"CookieHCl/cookiehcl.github.io","issue_term":"pathname","theme":"github-light"}</script> <script defer src=/js/third-party/comments/utterances.js></script> 