<!doctype html><html lang=en><meta charset=UTF-8><meta content="width=device-width" name=viewport><meta content=#222 name=theme-color><meta content="Hexo 8.0.0" name=generator><link crossorigin href=https://cdnjs.cloudflare.com rel=preconnect><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css rel=stylesheet><link integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"cookiehcl.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"agate","dark":"agate"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":true,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script defer src=/js/config.js></script><meta content="Google TPU Google TPU Version 1.0 does 64,000 multiplication per cycle! It can multiply 256x256 matrix! Two important things in parallel computing are making small unit and providing new data every cy" name=description><meta content=article property=og:type><meta content="Verilog Design" property=og:title><meta content=https://cookiehcl.github.io/posts/39/index.html property=og:url><meta content="기억 저장소" property=og:site_name><meta content="Google TPU Google TPU Version 1.0 does 64,000 multiplication per cycle! It can multiply 256x256 matrix! Two important things in parallel computing are making small unit and providing new data every cy" property=og:description><meta content=en_US property=og:locale><meta content=https://cookiehcl.github.io/posts/39/systolic_array.png property=og:image><meta content=2025-03-11T00:01:00.000Z property=article:published_time><meta content=2025-03-11T00:01:00.000Z property=article:modified_time><meta content=CookieHCl property=article:author><meta content=summary name=twitter:card><meta content=https://cookiehcl.github.io/posts/39/systolic_array.png name=twitter:image><link href=https://cookiehcl.github.io/posts/39/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://cookiehcl.github.io/posts/39/","path":"posts/39/","title":"Verilog Design"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Verilog Design | 기억 저장소</title><script integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script defer src=/js/utils.js></script><script defer src=/js/motion.js></script><script defer src=/js/sidebar.js></script><script defer src=/js/next-boot.js></script><script integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin defer src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js></script><script defer src=/js/third-party/search/local-search.js></script><script class=next-config data-name=mermaid type=application/json>{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.10.1/mermaid.min.js","integrity":"sha256-BmQmdWDS8X2OTbrwELWK366LV6escyWhHHe0XCTU/Hk="}}</script><script defer src=/js/third-party/tags/mermaid.js></script><script class=next-config data-name=enableMath type=application/json>true</script><link integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css rel=stylesheet><script class=next-config data-name=katex type=application/json>{"copy_tex_js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js","integrity":"sha256-Us54+rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs="}}</script><script defer src=/js/third-party/math/katex.js></script><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label="Toggle navigation bar" class=toggle role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><a class=brand href=/ rel=start> <i class=logo-line></i> <p class=site-title>기억 저장소</p> <i class=logo-line></i> </a></div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=Search role=button><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>About</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>Tags</a><li class="menu-item menu-item-categories"><a href=/categories/ rel=section><i class="fa fa-th fa-fw"></i>Categories</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>Archives</a><li class="menu-item menu-item-search"><a class=popup-trigger role=button><i class="fa fa-search fa-fw"></i>Search </a></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon> <i class="fa fa-search"></i> </span><div class=search-input-container><input autocapitalize=off autocomplete=off class=search-input maxlength=80 placeholder=Searching... spellcheck=false type=search></div><span class=popup-btn-close role=button> <i class="fa fa-times-circle"></i> </span></div><div class=search-result-container><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>Table of Contents<li class=sidebar-nav-overview>Overview</ul><div class=sidebar-panel-container><!--noindex--><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>1.</span> <span class=nav-text>Google TPU</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#Systolic-array><span class=nav-number>1.1.</span> <span class=nav-text>Systolic array</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#TPUv4i><span class=nav-number>1.2.</span> <span class=nav-text>TPUv4i</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>2.</span> <span class=nav-text>HDL-Based Design flow</span></a><li class="nav-item nav-level-1"><a class=nav-link><span class=nav-number>3.</span> <span class=nav-text>Verliog</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#Values><span class=nav-number>3.1.</span> <span class=nav-text>Values</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Data-Types><span class=nav-number>3.2.</span> <span class=nav-text>Data Types</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Wire><span class=nav-number>3.2.1.</span> <span class=nav-text>Wire</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Reg><span class=nav-number>3.2.2.</span> <span class=nav-text>Reg</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Time><span class=nav-number>3.2.3.</span> <span class=nav-text>Time</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Vector><span class=nav-number>3.2.4.</span> <span class=nav-text>Vector</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Array><span class=nav-number>3.2.5.</span> <span class=nav-text>Array</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Operators><span class=nav-number>3.3.</span> <span class=nav-text>Operators</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Reduction-operators><span class=nav-number>3.3.1.</span> <span class=nav-text>Reduction operators</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Equality-operators><span class=nav-number>3.3.2.</span> <span class=nav-text>Equality operators</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Delay-control><span class=nav-number>3.4.</span> <span class=nav-text>Delay control</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Regular-delay-control><span class=nav-number>3.4.1.</span> <span class=nav-text>Regular delay control</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Intra-Assignment-delay-control><span class=nav-number>3.4.2.</span> <span class=nav-text>Intra-Assignment delay control</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Blocks><span class=nav-number>3.5.</span> <span class=nav-text>Blocks</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#initial-block><span class=nav-number>3.5.1.</span> <span class=nav-text>initial block</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#always-block><span class=nav-number>3.5.2.</span> <span class=nav-text>always block</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Assignments><span class=nav-number>3.6.</span> <span class=nav-text>Assignments</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Parameterized-Modules><span class=nav-number>3.7.</span> <span class=nav-text>Parameterized Modules</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#loops><span class=nav-number>3.8.</span> <span class=nav-text>loops</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#while-statement><span class=nav-number>3.8.1.</span> <span class=nav-text>while statement</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#for-statement><span class=nav-number>3.8.2.</span> <span class=nav-text>for statement</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#repeat-statement><span class=nav-number>3.8.3.</span> <span class=nav-text>repeat statement</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#generate-block><span class=nav-number>3.8.4.</span> <span class=nav-text>generate block</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Module-Modeling-Styles><span class=nav-number>3.9.</span> <span class=nav-text>Module Modeling Styles</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Structural-style><span class=nav-number>3.9.1.</span> <span class=nav-text>Structural style</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Dataflow-style><span class=nav-number>3.9.2.</span> <span class=nav-text>Dataflow style</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Behavioral-or-algorithmic-style><span class=nav-number>3.9.3.</span> <span class=nav-text>Behavioral or algorithmic style</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Synthesizing-conditional-statements><span class=nav-number>3.10.</span> <span class=nav-text>Synthesizing conditional statements</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#Latch-inference><span class=nav-number>3.10.1.</span> <span class=nav-text>Latch inference</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Filp-flop-inference><span class=nav-number>3.10.2.</span> <span class=nav-text>Filp-flop inference</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#Filp-flops><span class=nav-number>3.11.</span> <span class=nav-text>Filp-flops</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Memory-elements><span class=nav-number>3.12.</span> <span class=nav-text>Memory elements</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Shift-registers><span class=nav-number>3.13.</span> <span class=nav-text>Shift registers</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Counters><span class=nav-number>3.14.</span> <span class=nav-text>Counters</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Finite-State-Machines-FSMs><span class=nav-number>3.15.</span> <span class=nav-text>Finite-State Machines (FSMs)</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#FSM-Modeling-Style><span class=nav-number>3.15.1.</span> <span class=nav-text>FSM Modeling Style</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#Logic-Optimization><span class=nav-number>3.15.2.</span> <span class=nav-text>Logic Optimization</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#Combinational-circuit-optimization-Two-level-simplification><span class=nav-number>3.15.2.1.</span> <span class=nav-text>Combinational circuit optimization: Two-level simplification</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#Sequential-circuit-optimization-State-minimization><span class=nav-number>3.15.2.2.</span> <span class=nav-text>Sequential circuit optimization: State minimization</span></a></ol></ol></ol></ol></div></div><!--/noindex--><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><p class=site-author-name itemprop=name>CookieHCl<div class=site-description itemprop=description></div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/> <span class=site-state-item-count>109</span> <span class=site-state-item-name>posts</span> </a></div><div class="site-state-item site-state-categories"><a href=/categories/> <span class=site-state-item-count>25</span> <span class=site-state-item-name>categories</span></a></div></nav></div><div class="links-of-author animated"><span class=links-of-author-item> <a rel="noopener me" title="GitHub → https://github.com/CookieHCl" href=https://github.com/CookieHCl target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item> <a rel="noopener me" title="BOJ → https://www.acmicpc.net/user/CookieHCl" href=https://www.acmicpc.net/user/CookieHCl target=_blank><i class="fa fa-code fa-fw"></i>BOJ</a> </span><span class=links-of-author-item> <a rel="noopener me" title="solved.ac → https://solved.ac/profile/CookieHCl" href=https://solved.ac/profile/CookieHCl target=_blank><i class="fa fa-audio-description fa-fw"></i>solved.ac</a> </span></div><div class="cc-license animated" itemprop=license><a class=cc-opacity href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ko rel=noopener target=_blank><img alt="Creative Commons" src=https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg></a></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article lang=en><link href=https://cookiehcl.github.io/posts/39/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person> <meta content=/images/avatar.gif itemprop=image> <meta content=CookieHCl itemprop=name> </span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization> <meta content="기억 저장소" itemprop=name> <meta itemprop=description> </span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork> <meta content="Verilog Design | 기억 저장소" itemprop=name> <meta itemprop=description> </span><header class=post-header><h1 itemprop="name headline" class=post-title>Verilog Design</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-calendar"></i> </span> <span class=post-meta-item-text>Posted on</span> <time itemprop="dateCreated datePublished" title="Created: 2025-03-11 09:01:00" datetime=2025-03-11T09:01:00+09:00>2025-03-11</time> </span><span class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-folder"></i> </span> <span class=post-meta-item-text>In</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/ itemprop=url rel=index><span itemprop=name>SNU</span></a> </span> , <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/4-1/ itemprop=url rel=index><span itemprop=name>4-1</span></a> </span> , <span itemprop=about itemscope itemtype=http://schema.org/Thing> <a href=/categories/SNU/4-1/%ED%95%98%EB%93%9C%EC%9B%A8%EC%96%B4%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%84%A4%EA%B3%84/ itemprop=url rel=index><span itemprop=name>하드웨어시스템설계</span></a> </span> </span><span title="Reading time" class=post-meta-item> <span class=post-meta-item-icon> <i class="far fa-clock"></i> </span> <span class=post-meta-item-text>Reading time ≈</span> <span>4 mins.</span> </span></div></div></header><div class=post-body itemprop=articleBody><h1>Google TPU</h1><p>Google TPU Version 1.0 does 64,000 multiplication per cycle!<br> It can multiply 256x256 matrix!<p>Two important things in parallel computing are making small unit and providing new data every cycle.<br> How does Google TPU multiply 256x256 matrix?<h2 id=Systolic-array>Systolic array</h2><p><img alt="Systolic Array" src=systolic_array.png><p>Let's assume we'll multiply 3x3 matrix.<br> Sytolic aray has 3x3 Multiply-Accumulate (MAC) units.<br> MAC gets two input, multiply it, and add it to register (accumulate).<br> Reset signal sets accumulator to 0.<p>The input will be received for 5 cycles from two directions!<br> Each cycle, MAC does MAC, and pass inputs to corresponding direction.<br> After 7 cycles, each MAC holds result!<h2 id=TPUv4i>TPUv4i</h2><p>TPUv4i uses 32x32 systolic array with 4x4 dot product to multiply 128x128 matrix.<br> Instead of sending numbers one at a time, we send 4 numbers at a time.<br> 4 MAC need 4 multiplication, 4 addition, and 4 registers. 4x4 dot product only need 4 multiplication, 3 addition, and 1 register!<h1>HDL-Based Design flow</h1><ol><li>Hardware Specification using C or Matlab<li>Behavioral/RTL Modeling (HDL)<li>Behavioral/RTL Modeling (HDL)<li>Synthesis<li>Gate-level Simulation<li>Place & Route (connecting wires)<li>Verify timing constraints (e.g. wire delays)<li>Bit-stream Generation<li>FPGA test<li>ASIC Design (Test passed, now make real hardware!)</ol><h1>Verliog</h1><h2 id=Values>Values</h2><p>Uses sized number e.g. 4'b11, 5'd3, etc.<br> The size can be omitted for 32-bit numbers.<p>x value means conflicting drivers, i.e. connected to both supply voltage and ground.<br> z value means floating state, i.e. not connected to both supply voltage and ground.<br> Generally we use x for an unknown value.<h2 id=Data-Types>Data Types</h2><h3 id=Wire>Wire</h3><p>Represents connection. They don't hold values!<h3 id=Reg>Reg</h3><p>Represents data storage.<br> Behaves like memory - they hold values until assigned.<br> Reg doesn't represents a physical register!<p><em>integer</em> represents 32 bit signed reg.<h3 id=Time>Time</h3><p>Time is unsigned value that is at least 64 bits.<br> Used for storing and manipulating simulation time.<h3 id=Vector>Vector</h3><p>Size of wire or register.<br> They can hold multiple bits!<h3 id=Array>Array</h3><p>Collection of single entities.<br> <code>wire [7:0] x[3:0];</code> means 4 of 8 bit vectors.<h2 id=Operators>Operators</h2><p>Arithmetic, Bitwise, etc.<br> Some operators may not be synthesizable! (e.g. % (modulus), ** (exponent), &lt;&lt;&lt;, >>> (arithmetic shift), ===, !== (case equality))<h3 id=Reduction-operators>Reduction operators</h3><p>Carry out a bit-wise operation on vector and yield a 1-bit result.<p>e.g. &A, ^A, ~|A, etc.<h3 id=Equality-operators>Equality operators</h3><p>==, != yields x if any operand is x or z.<br> ===, !== yields 1 if two operands exactly match. (including x or z!)<h2 id=Delay-control>Delay control</h2><h3 id=Regular-delay-control>Regular delay control</h3><p>Defers the execution of the entire statement.<br> Usually used for test bench. e.g. <code>#10 y = 1;</code><h3 id=Intra-Assignment-delay-control>Intra-Assignment delay control</h3><p>Defers the <em>assignment</em> to the left variable.<br> In <code>y = #25 ~x;</code>, ~x is calculated at #0, and assignment happens at #25.<h2 id=Blocks>Blocks</h2><h3 id=initial-block>initial block</h3><p>All initial block run at #0 once.<h3 id=always-block>always block</h3><p>Always block starts at #0, and executes continuously.<br> We can trigger always block with signals.<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line><span class=keyword>always</span> @(<span class=keyword>posedge</span> clock <span class=keyword>or</span> <span class=keyword>negedge</span> reset_n)</span><br><span class=line>    <span class=keyword>if</span> (!reset_n) q &lt;= <span class=number>1</span>`b0;</span><br><span class=line>    <span class=keyword>else</span>          q &lt;= d;</span><br></pre></table></figure><h2 id=Assignments>Assignments</h2><p>Blocking assignments (=) are executed in the program order.<br> Non-Blocking assignment (&lt;=) are executed concurrently.<h2 id=Parameterized-Modules>Parameterized Modules</h2><p>Similar to generics!<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line><span class=keyword>module</span> hazard_static (x, y, z, f);</span><br><span class=line>    <span class=keyword>parameter</span> delay1 = <span class=number>2</span>, delay2 = <span class=number>5</span>;</span><br><span class=line>    <span class=keyword>and</span> #delay2 a1 (b, x, y);</span><br><span class=line>    <span class=keyword>not</span> #delay1 n1 (a, x);</span><br><span class=line>    <span class=keyword>and</span> #delay2 a2 (c, a, z);</span><br><span class=line>    <span class=keyword>or</span> #delay2 o2 (f, b, c);</span><br><span class=line><span class=keyword>endmodule</span> </span><br><span class=line></span><br><span class=line><span class=keyword>defparam</span> example1<span class=variable>.delay1</span> = <span class=number>4</span>, example1<span class=variable>.delay2</span> = <span class=number>8</span>;</span><br><span class=line>hazard_static example1 (x, y, z, f);</span><br><span class=line>hazard_static <span class=variable>#(4, 8) example2 (x, y, z, f)</span>;</span><br><span class=line>hazard_static <span class=variable>#(.delay2(4), .delay1(6)) example3 (x, y, z, f)</span>;  </span><br></pre></table></figure><h2 id=loops>loops</h2><h3 id=while-statement>while statement</h3><figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=keyword>while</span> (i &lt;= <span class=number>7</span>) <span class=keyword>begin</span></span><br><span class=line>    <span class=keyword>if</span> (data[i] == <span class=number>0</span>) out = out + <span class=number>1</span>;</span><br><span class=line>    i = i + <span class=number>1</span>; </span><br><span class=line><span class=keyword>end</span></span><br></pre></table></figure><h3 id=for-statement>for statement</h3><figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line><span class=keyword>for</span> (i = <span class=number>0</span>; i &lt;= <span class=number>7</span>; i = i + <span class=number>1</span>)</span><br><span class=line>    <span class=keyword>if</span> (data[i] == <span class=number>0</span>) out = out + <span class=number>1</span>;</span><br></pre></table></figure><h3 id=repeat-statement>repeat statement</h3><p>Compiler repeats statement for fixed number of times.<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=keyword>repeat</span>(<span class=number>128</span>) <span class=keyword>begin</span></span><br><span class=line>    <span class=built_in>$display</span>(<span class=string>"Count = %d"</span>, count);</span><br><span class=line>    count = count + <span class=number>1</span>;</span><br><span class=line><span class=keyword>end</span></span><br></pre></table></figure><h3 id=generate-block>generate block</h3><p>Compiler unrolls generate block to statements.<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=keyword>genvar</span> i;</span><br><span class=line><span class=keyword>generate</span> <span class=keyword>for</span> (i = <span class=number>0</span>; i &lt; SIZE; i = i + <span class=number>1</span>) <span class=keyword>begin</span>: <span class=keyword>bit</span></span><br><span class=line>    <span class=keyword>assign</span> bin[i] = ^gray[SIZE-<span class=number>1</span>:i];</span><br><span class=line><span class=keyword>end</span> <span class=keyword>endgenerate</span></span><br></pre></table></figure><h2 id=Module-Modeling-Styles>Module Modeling Styles</h2><h3 id=Structural-style>Structural style</h3><figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line><span class=keyword>nor</span> g1 (b, x, y);</span><br><span class=line><span class=keyword>not</span> g2 (a, x);</span><br><span class=line><span class=keyword>and</span> g3 (c, a, z);</span><br><span class=line><span class=keyword>nor</span> g4 (f, b, c);</span><br></pre></table></figure><h3 id=Dataflow-style>Dataflow style</h3><figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line><span class=keyword>assign</span> cgt = (a > b);</span><br><span class=line><span class=keyword>assign</span> clt = (a &lt; b);</span><br><span class=line><span class=keyword>assign</span> ceq = (a == b);</span><br></pre></table></figure><h3 id=Behavioral-or-algorithmic-style>Behavioral or algorithmic style</h3><figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br></pre><td class=code><pre><span class=line><span class=keyword>always</span> @(*) <span class=keyword>begin</span></span><br><span class=line>    <span class=keyword>case</span> (select)</span><br><span class=line>        <span class=number>2'b11</span>: y = in3;</span><br><span class=line>        <span class=number>2'b10</span>: y = in2;</span><br><span class=line>        <span class=number>2'b01</span>: y = in1;</span><br><span class=line>        <span class=number>2'b00</span>: y = in0;</span><br><span class=line>        <span class=keyword>default</span>: y = N{<span class=number>1'b0</span>};</span><br><span class=line>    <span class=keyword>endcase</span></span><br><span class=line><span class=keyword>end</span></span><br><span class=line></span><br><span class=line><span class=keyword>always</span> @(*) <span class=keyword>begin</span></span><br><span class=line>    <span class=comment>// x bits are ignored in casex</span></span><br><span class=line>    <span class=keyword>casex</span> (in)</span><br><span class=line>        <span class=number>4'b1xxx</span>: y = <span class=number>3</span>;</span><br><span class=line>        <span class=number>4'b01xx</span>: y = <span class=number>2</span>;</span><br><span class=line>        <span class=number>4'b001x</span>: y = <span class=number>1</span>;</span><br><span class=line>        <span class=number>4'b0001</span>: y = <span class=number>0</span>;</span><br><span class=line>        <span class=keyword>default</span>: y = <span class=number>2'bx</span>;</span><br><span class=line>    <span class=keyword>endcase</span></span><br><span class=line><span class=keyword>end</span></span><br></pre></table></figure><h2 id=Synthesizing-conditional-statements>Synthesizing conditional statements</h2><p>Complete conditional statement will usually synthesized into a 2-to-1 multiplexer.<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line><span class=keyword>always</span> @(enable <span class=keyword>or</span> data) </span><br><span class=line>    <span class=keyword>if</span> (enable) y = data;</span><br><span class=line>    <span class=keyword>else</span> y = x;</span><br></pre></table></figure><h3 id=Latch-inference>Latch inference</h3><p>Incomplete conditional statement or assigning itself will be synthesized into latch.<br> To avoid this, initialize variable before conditional statement or only use complete conditional statement.<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br></pre><td class=code><pre><span class=line><span class=keyword>always</span> @(select <span class=keyword>or</span> data) </span><br><span class=line>    <span class=keyword>case</span> (select)</span><br><span class=line>        <span class=number>2'b00</span>: y = data[select];</span><br><span class=line>        <span class=number>2'b01</span>: y = data[select];</span><br><span class=line>        <span class=number>2'b10</span>: y = data[select];</span><br><span class=line>        <span class=comment>// no default statement, latch inference</span></span><br><span class=line>    <span class=keyword>endcase</span></span><br><span class=line></span><br><span class=line><span class=keyword>always</span> @(enable <span class=keyword>or</span> data) </span><br><span class=line>    <span class=keyword>if</span> (enable) y = data;</span><br><span class=line>    <span class=comment>// no else statement, latch inference</span></span><br><span class=line></span><br><span class=line><span class=keyword>always</span> @(enable <span class=keyword>or</span> data) </span><br><span class=line>    <span class=keyword>if</span> (enable) y = data;</span><br><span class=line>    <span class=keyword>else</span> y = y; <span class=comment>// latch inference</span></span><br><span class=line></span><br><span class=line><span class=keyword>always</span> @(<span class=keyword>posedge</span> clk) </span><br><span class=line>    <span class=keyword>if</span> (enable) y &lt;= data;</span><br><span class=line>    <span class=keyword>else</span> y &lt;= y; <span class=comment>// NOT latch inference, this redundant expression will be removed</span></span><br></pre></table></figure><h3 id=Filp-flop-inference>Filp-flop inference</h3><p>Similarly, assignment to a register will be synthesized into flip-flop.<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line><span class=keyword>always</span> @(<span class=keyword>posedge</span> clk) </span><br><span class=line>    y &lt;= x <span class=comment>// flip-flop inference</span></span><br></pre></table></figure><h2 id=Filp-flops>Filp-flops</h2><p>Filp-flops sample input only once in a clock period, while latches sample input when the clock is high.<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br></pre><td class=code><pre><span class=line><span class=comment>// D-type flip-flop</span></span><br><span class=line><span class=keyword>module</span> DFF (clk, d, q);</span><br><span class=line><span class=keyword>input</span> clk, d;</span><br><span class=line><span class=keyword>output</span> <span class=keyword>reg</span> q;</span><br><span class=line>    <span class=keyword>always</span> @(<span class=keyword>posedge</span> clk) q &lt;= d;</span><br><span class=line><span class=keyword>endmodule</span></span><br><span class=line></span><br><span class=line><span class=comment>// asynchronous reset D-type flip-flop</span></span><br><span class=line><span class=keyword>module</span> DFF_async_reset (clk, reset_n, d, q);</span><br><span class=line><span class=keyword>input</span> clk, reset_n, d;</span><br><span class=line><span class=keyword>output</span> <span class=keyword>reg</span> q;</span><br><span class=line></span><br><span class=line><span class=keyword>always</span> @(<span class=keyword>posedge</span> clk <span class=keyword>or</span> <span class=keyword>negedge</span> reset_n)</span><br><span class=line>    <span class=keyword>if</span> (!reset_n) q &lt;= <span class=number>0</span>;</span><br><span class=line>    <span class=keyword>else</span>          q &lt;= d;</span><br><span class=line><span class=keyword>endmodule</span></span><br><span class=line></span><br><span class=line><span class=comment>// synchronous reset D-type flip-flop</span></span><br><span class=line><span class=keyword>module</span> DFF_sync_reset (clk, reset_n, d, q);</span><br><span class=line><span class=keyword>input</span> clk, reset_n, d;</span><br><span class=line><span class=keyword>output</span> <span class=keyword>reg</span> q;</span><br><span class=line></span><br><span class=line><span class=keyword>always</span> @(<span class=keyword>posedge</span> clk)</span><br><span class=line>    <span class=keyword>if</span> (!reset_n) q &lt;= <span class=number>0</span>;</span><br><span class=line>    <span class=keyword>else</span>          q &lt;= d;</span><br><span class=line><span class=keyword>endmodule</span></span><br></pre></table></figure><h2 id=Memory-elements>Memory elements</h2><p>It's just n-bit D-Type flip-flops!<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre><td class=code><pre><span class=line><span class=keyword>module</span> register (clk, load, reset_n, din, qout);</span><br><span class=line><span class=keyword>parameter</span> N = <span class=number>4</span>;</span><br><span class=line><span class=keyword>input</span> clk, load, reset_n;  </span><br><span class=line><span class=keyword>input</span> [N-<span class=number>1</span>:<span class=number>0</span>] din;</span><br><span class=line><span class=keyword>output</span> <span class=keyword>reg</span> [N-<span class=number>1</span>:<span class=number>0</span>] qout;</span><br><span class=line></span><br><span class=line><span class=keyword>always</span> @(<span class=keyword>posedge</span> clk <span class=keyword>or</span> <span class=keyword>negedge</span> reset_n)</span><br><span class=line>   <span class=keyword>if</span> (!reset_n) qout &lt;= {N{<span class=number>1'b0</span>}}; <span class=comment>// async reset</span></span><br><span class=line>   <span class=keyword>else</span> <span class=keyword>if</span> (load) qout &lt;= din; <span class=comment>// only load when signaled, so we don't have to provide the data every cycle</span></span><br><span class=line>    <span class=comment>// verilog inferences else quout &lt;= qout; </span></span><br><span class=line><span class=keyword>endmodule</span></span><br></pre></table></figure><p>Normally, we use register file with one-write and two-read ports.<br> Most operation has 2 inputs and 1 output. (e.g. A + B = C)<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br></pre><td class=code><pre><span class=line><span class=keyword>parameter</span> M = <span class=number>4</span>;   <span class=comment>// number of address bits</span></span><br><span class=line><span class=keyword>parameter</span> N = <span class=number>16</span>;  <span class=comment>// number of words, N = 2^M</span></span><br><span class=line><span class=keyword>parameter</span> W = <span class=number>8</span>;   <span class=comment>// number of bits in a word</span></span><br><span class=line><span class=keyword>input</span>          clk, wr_enable;</span><br><span class=line><span class=keyword>input</span>  [W-<span class=number>1</span>:<span class=number>0</span>] din;</span><br><span class=line><span class=keyword>output</span> [W-<span class=number>1</span>:<span class=number>0</span>] douta, doutb;</span><br><span class=line><span class=keyword>input</span>  [M-<span class=number>1</span>:<span class=number>0</span>] rd_addra, rd_addrb, wr_addr;</span><br><span class=line><span class=keyword>reg</span>    [W-<span class=number>1</span>:<span class=number>0</span>] reg_file [N-<span class=number>1</span>:<span class=number>0</span>];</span><br><span class=line></span><br><span class=line><span class=keyword>assign</span> douta = reg_file[rd_addra];</span><br><span class=line><span class=keyword>assign</span> doutb = reg_file[rd_addrb];</span><br><span class=line><span class=keyword>always</span> @(<span class=keyword>posedge</span> clk)</span><br><span class=line>    <span class=keyword>if</span> (wr_enable) reg_file[wr_addr] &lt;= din;</span><br></pre></table></figure><p>Large register file is often implemented with SRAM (Synchronous Random Access Memory) circuit.<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br></pre><td class=code><pre><span class=line><span class=keyword>parameter</span> N = <span class=number>16</span>;  <span class=comment>// number of words, N = 2^M</span></span><br><span class=line><span class=keyword>parameter</span> A = <span class=number>4</span>;   <span class=comment>// number of address bits</span></span><br><span class=line><span class=keyword>parameter</span> W = <span class=number>8</span>;   <span class=comment>// number of bits in a word</span></span><br><span class=line><span class=keyword>input</span>      [A-<span class=number>1</span>:<span class=number>0</span>] addr;</span><br><span class=line><span class=keyword>input</span>      [W-<span class=number>1</span>:<span class=number>0</span>] din;</span><br><span class=line><span class=keyword>input</span>              cs, wr, clk;</span><br><span class=line><span class=keyword>output</span> <span class=keyword>reg</span> [W-<span class=number>1</span>:<span class=number>0</span>] dout;</span><br><span class=line><span class=keyword>reg</span>        [W-<span class=number>1</span>:<span class=number>0</span>] ram[N-<span class=number>1</span>:<span class=number>0</span>];</span><br><span class=line></span><br><span class=line><span class=keyword>always</span> @(<span class=keyword>posedge</span> clk)</span><br><span class=line>    <span class=keyword>if</span> (cs) <span class=keyword>begin</span> <span class=comment>// chip select signals</span></span><br><span class=line>        <span class=keyword>if</span> (wr) ram[addr] &lt;= din;</span><br><span class=line>        <span class=keyword>else</span> dout &lt;= ram[addr];</span><br><span class=line>    <span class=keyword>end</span></span><br></pre></table></figure><h2 id=Shift-registers>Shift registers</h2><p>Normally used in multiplication and divison.<br> We need load signal to load data in 1 cycle!<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre><td class=code><pre><span class=line><span class=keyword>module</span> universal_shift_register (clk, reset_n, s1, s0, lsi, rsi, din, qout);</span><br><span class=line><span class=keyword>parameter</span> N = <span class=number>4</span>;  <span class=comment>// define the default size</span></span><br><span class=line><span class=keyword>input</span>              clk, reset_n, s1, s0, lsi, rsi;</span><br><span class=line><span class=keyword>input</span>      [N-<span class=number>1</span>:<span class=number>0</span>] din;</span><br><span class=line><span class=keyword>output</span> <span class=keyword>reg</span> [N-<span class=number>1</span>:<span class=number>0</span>] qout;</span><br><span class=line></span><br><span class=line><span class=keyword>always</span> @(<span class=keyword>posedge</span> clk <span class=keyword>or</span> <span class=keyword>negedge</span> reset_n)</span><br><span class=line>   <span class=keyword>if</span> (!reset_n) qout &lt;= {N{<span class=number>1'b0</span>}};</span><br><span class=line>   <span class=keyword>else</span> <span class=keyword>case</span> ({s1,s0})</span><br><span class=line>        <span class=number>2'b00</span>: ; <span class=comment>// qout &lt;= qout;           // No change</span></span><br><span class=line>        <span class=number>2'b01</span>: qout &lt;= {rsi, qout[N-<span class=number>1</span>:<span class=number>1</span>]};  <span class=comment>// Shift right</span></span><br><span class=line>        <span class=number>2'b10</span>: qout &lt;= {qout[N-<span class=number>2</span>:<span class=number>0</span>], lsi};  <span class=comment>// Shift left</span></span><br><span class=line>        <span class=number>2'b11</span>: qout &lt;= din;                 <span class=comment>// Parallel load</span></span><br><span class=line>   <span class=keyword>endcase</span></span><br><span class=line><span class=keyword>endmodule</span></span><br></pre></table></figure><h2 id=Counters>Counters</h2><p>Counters are implemented by using previous output as a clock!<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br></pre><td class=code><pre><span class=line><span class=comment>// an N-bit ripple counter using generate blocks</span></span><br><span class=line><span class=keyword>parameter</span> N = <span class=number>4</span>; <span class=comment>// define the size of counter</span></span><br><span class=line><span class=keyword>input</span>              clk, enable, reset_n;</span><br><span class=line><span class=keyword>output</span> <span class=keyword>reg</span> [N-<span class=number>1</span>:<span class=number>0</span>] qout;</span><br><span class=line><span class=keyword>genvar</span>             i;</span><br><span class=line></span><br><span class=line><span class=keyword>generate</span> <span class=keyword>for</span> (i = <span class=number>0</span>; i &lt; N; i = i + <span class=number>1</span>) <span class=keyword>begin</span>: ripple_counter</span><br><span class=line>    <span class=keyword>if</span> (i == <span class=number>0</span>) <span class=comment>// specify LSB</span></span><br><span class=line>        <span class=keyword>always</span> @(<span class=keyword>negedge</span> clk <span class=keyword>or</span> <span class=keyword>negedge</span> reset_n)</span><br><span class=line>            <span class=keyword>if</span> (!reset_n)    qout[<span class=number>0</span>] &lt;= <span class=number>1'b0</span>;</span><br><span class=line>            <span class=keyword>else</span> <span class=keyword>if</span> (enable) qout[<span class=number>0</span>] &lt;= ~qout[<span class=number>0</span>];</span><br><span class=line>    <span class=keyword>else</span> <span class=comment>// specify the rest bits</span></span><br><span class=line>        <span class=keyword>always</span> @(<span class=keyword>negedge</span> qout[i-<span class=number>1</span>] <span class=keyword>or</span> <span class=keyword>negedge</span> reset_n) </span><br><span class=line>            <span class=keyword>if</span> (!reset_n)    qout[i] &lt;= <span class=number>1'b0</span>;</span><br><span class=line>            <span class=keyword>else</span> <span class=keyword>if</span> (enable) qout[i] &lt;= ~qout[i];</span><br><span class=line><span class=keyword>end</span> <span class=keyword>endgenerate</span></span><br></pre></table></figure><p>Of course, we can just let verilog to make it.<figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre><td class=code><pre><span class=line><span class=keyword>module</span> updn_bincounter (clk, reset, eup, edn, qout, cout, bout);</span><br><span class=line><span class=keyword>parameter</span>          N = <span class=number>4</span>;</span><br><span class=line><span class=keyword>input</span>              clk, reset, eup, edn;</span><br><span class=line><span class=keyword>output</span> <span class=keyword>reg</span> [N-<span class=number>1</span>:<span class=number>0</span>] qout;</span><br><span class=line><span class=keyword>output</span>             cout, bout;</span><br><span class=line></span><br><span class=line><span class=keyword>always</span> @(<span class=keyword>posedge</span> clk)</span><br><span class=line>   <span class=keyword>if</span> (reset)    qout &lt;= {N{<span class=number>1'b0</span>}};  <span class=comment>// synchronous reset</span></span><br><span class=line>   <span class=keyword>else</span> <span class=keyword>if</span> (eup) qout &lt;= qout + <span class=number>1</span>;   <span class=comment>// up counter</span></span><br><span class=line>   <span class=keyword>else</span> <span class=keyword>if</span> (edn) qout &lt;= qout - <span class=number>1</span>;   <span class=comment>// down counter</span></span><br><span class=line><span class=keyword>assign</span> #<span class=number>1</span> cout = (&qout) & eup;      <span class=comment>// generate carry out</span></span><br><span class=line><span class=keyword>assign</span> #<span class=number>1</span> bout = (~|qout) & edn;     <span class=comment>// generate borrow out</span></span><br></pre></table></figure><h2 id=Finite-State-Machines-FSMs>Finite-State Machines (FSMs)</h2><p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>M</mi><mo>=</mo><mo stretchy=false>(</mo><mi>I</mi><mo separator=true>,</mo><mi>O</mi><mo separator=true>,</mo><mi>S</mi><mo separator=true>,</mo><mi>d</mi><mo separator=true>,</mo><mi>l</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>M = (I, O, S, d, l) </annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.10903em;>M</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>=</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:1em;vertical-align:-0.25em;></span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:0.07847em;>I</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>S</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal">d</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.01968em;>l</span><span class=mclose>)</span></span></span></span></span><ul><li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>I</mi><mo separator=true>,</mo><mi>O</mi><mo separator=true>,</mo><mi>S</mi></mrow><annotation encoding=application/x-tex>I, O, S</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.8778em;vertical-align:-0.1944em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>I</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span><span class=mpunct>,</span><span class=mspace style=margin-right:0.1667em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>S</span></span></span></span> are finite, nonempty sets of inputs, outputs, and states.<li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>d</mi><mo>:</mo><mi>I</mi><mo>×</mo><mi>S</mi><mo>→</mo><mi>S</mi></mrow><annotation encoding=application/x-tex>d: I \times S \rightarrow S</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal">d</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>:</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7667em;vertical-align:-0.0833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>I</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>×</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>S</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>→</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>S</span></span></span></span> is a state transition function.<li><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>l</mi></mrow><annotation encoding=application/x-tex>l</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal" style=margin-right:0.01968em;>l</span></span></span></span> is a output function. <ul><li>Mealy machine: <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>l</mi><mo>:</mo><mi>I</mi><mo>×</mo><mi>S</mi><mo>→</mo><mi>O</mi></mrow><annotation encoding=application/x-tex>l: I \times S \rightarrow O</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal" style=margin-right:0.01968em;>l</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>:</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.7667em;vertical-align:-0.0833em;></span><span class="mord mathnormal" style=margin-right:0.07847em;>I</span><span class=mspace style=margin-right:0.2222em;></span><span class=mbin>×</span><span class=mspace style=margin-right:0.2222em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>S</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>→</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span></span></span></span><li>Moore machine: <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>l</mi><mo>:</mo><mi>S</mi><mo>→</mo><mi>O</mi></mrow><annotation encoding=application/x-tex>l: S \rightarrow O</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:0.6944em;></span><span class="mord mathnormal" style=margin-right:0.01968em;>l</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>:</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.05764em;>S</span><span class=mspace style=margin-right:0.2778em;></span><span class=mrel>→</span><span class=mspace style=margin-right:0.2778em;></span></span><span class=base><span class=strut style=height:0.6833em;></span><span class="mord mathnormal" style=margin-right:0.02778em;>O</span></span></span></span></ul></ul><h3 id=FSM-Modeling-Style>FSM Modeling Style</h3><ol><li><p>Initialize and update the state register</p> <figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line><span class=keyword>always</span> @(<span class=keyword>posedge</span> clk <span class=keyword>or</span> <span class=keyword>negedge</span> reset_n)</span><br><span class=line>    <span class=keyword>if</span> (!reset_n) present_state &lt;= A;</span><br><span class=line>    <span class=keyword>else</span>          present_state &lt;= next_state;</span><br></pre></table></figure><li><p>Determine next state</p> <figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line><span class=keyword>always</span> @(present_state <span class=keyword>or</span> x) </span><br><span class=line>    <span class=keyword>case</span> (present_state)</span><br><span class=line>        A: <span class=keyword>if</span> (x) next_state &lt;= B; <span class=keyword>else</span> next_state &lt;= C;</span><br></pre></table></figure><li><p>Determine output and internal registers</p> <figure class="highlight verilog"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line><span class=keyword>always</span> @(present_state) <span class=comment>// Moore machine</span></span><br><span class=line><span class=keyword>always</span> @(present_state <span class=keyword>or</span> x) <span class=comment>// Mealey machine</span></span><br><span class=line>    <span class=keyword>case</span> (present_state)</span><br><span class=line>        A: out = <span class=number>0</span>;</span><br><span class=line>        B: out = <span class=number>1</span>;</span><br></pre></table></figure></ol><h3 id=Logic-Optimization>Logic Optimization</h3><p>Optimization has two goals - combinational circuit optimization and state minimization.<br> Combinational circuit optimization reduces logic, and state minimization reduces flip-flops.<h4 id=Combinational-circuit-optimization-Two-level-simplification>Combinational circuit optimization: Two-level simplification</h4><ul><li>Implicant: elements of ON-set or DC-set that can be combined to form a subcube<li>Prime implicant (PI): implicant that can't be combined with another to form a larger subcube<li>Essential prime implicant (EPI): PI that participates in all possible covers of the ON-set, i.e. PI that covers an element of ON-set uniquely.</ul><p>Goal: Cover the ON-set with as few prime implicants as possible!<br> Quine-McCluskey Method (Q-M Method) is an exact algorithm that reduces a minterm expression to a minimal form.<ol><li>Find all PIs. <ol><li>Assume don't cares as ON-set.<li>Find two product terms that has exactly one-bit difference and combine them.<li>Mark product terms that were combined to reduce.<li>Repeat until no more combinations are possible.<li>Remaining unmarked product terms are PIs.</ol><li>Select a minimal set of PIs using a prime implicant chart (PI chart). <ol><li>Create a PI chart. <ol><li>List all PIs in the rows.<li>List all ON-set minterms in the columns. (Ignore don't cares)<li>Mark minterms that are coverd by each PI.</ol><li>Select all EPIs (PI that covers a minterm uniquely).<li>Select a minimum number of additional non-EPIs that covers remaining ON-set.</ol></ol><h4 id=Sequential-circuit-optimization-State-minimization>Sequential circuit optimization: State minimization</h4><ul><li>Equivalent States: States with same output and same transition behavior.<br> For all input combinations, states transition to same or equivalent states.</ul><p>Goal: identify and combine equivalent states!<br> Row Matching Method is a polynomial time procedure that minimize states.<ol><li>Place all states.<li>Initially partition set based on output behavior. (Ignore transition behavior.)<li>Partition each set based on transition behavior. (Ignore output behavior.)<br> If states transition to same set, it has same transition behavior.<li>Repeat partitioning with transition until no further partitioning is required.</ol></div><footer class=post-footer><div class=post-nav><div class=post-nav-item><a title="HCI and User Experience" href=/posts/37/ rel=prev> <i class="fa fa-angle-left"></i> HCI and User Experience </a></div><div class=post-nav-item><a title="Historical Perspective of HCI" href=/posts/40/ rel=next> Historical Perspective of HCI <i class="fa fa-angle-right"></i> </a></div></div></footer></article></div><div class="comments utterances-container"></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© 2023 – <span itemprop=copyrightYear>2025</span><span class=with-love> <i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>CookieHCl</span></div><div class=powered-by>Powered by <a href=https://hexo.io/ rel=noopener target=_blank>Hexo</a> & <a href=https://theme-next.js.org/muse/ rel=noopener target=_blank>NexT.Muse</a></div></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label="Back to top" class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><div class=reading-progress-bar></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script class=next-config data-name=utterances type=application/json>{"enable":true,"repo":"CookieHCl/cookiehcl.github.io","issue_term":"pathname","theme":"github-light"}</script><script defer src=/js/third-party/comments/utterances.js></script>